function t(t){let e=t[0],i=t[1],s=t[2];return Math.sqrt(e*e+i*i+s*s)}function e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function i(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function s(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function n(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function r(t){let e=t[0],i=t[1],s=t[2];return e*e+i*i+s*s}function o(t,e){let i=e[0],s=e[1],n=e[2],r=i*i+s*s+n*n;return r>0&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function a(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function l(t,e,i){let s=e[0],n=e[1],r=e[2],o=i[0],a=i[1],l=i[2];return t[0]=n*l-r*a,t[1]=r*o-s*l,t[2]=s*a-n*o,t}const h=function(){const t=[0,0,0],i=[0,0,0];return function(s,n){e(t,s),e(i,n),o(t,t),o(i,i);let r=a(t,i);return r>1?0:r<-1?Math.PI:Math.acos(r)}}();class p extends Array{constructor(t=0,e=t,i=t){return super(t,e,i),this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(t){this[0]=t}set y(t){this[1]=t}set z(t){this[2]=t}set(t,e=t,i=t){return t.length?this.copy(t):(function(t,e,i,s){t[0]=e,t[1]=i,t[2]=s}(this,t,e,i),this)}copy(t){return e(this,t),this}add(t,e){return e?i(this,t,e):i(this,this,t),this}sub(t,e){return e?s(this,t,e):s(this,this,t),this}multiply(t){var e,i,s;return t.length?(i=this,s=t,(e=this)[0]=i[0]*s[0],e[1]=i[1]*s[1],e[2]=i[2]*s[2]):n(this,this,t),this}divide(t){var e,i,s;return t.length?(i=this,s=t,(e=this)[0]=i[0]/s[0],e[1]=i[1]/s[1],e[2]=i[2]/s[2]):n(this,this,1/t),this}inverse(t=this){var e,i;return i=t,(e=this)[0]=1/i[0],e[1]=1/i[1],e[2]=1/i[2],this}len(){return t(this)}distance(e){return e?function(t,e){let i=e[0]-t[0],s=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(i*i+s*s+n*n)}(this,e):t(this)}squaredLen(){return r(this)}squaredDistance(t){return t?function(t,e){let i=e[0]-t[0],s=e[1]-t[1],n=e[2]-t[2];return i*i+s*s+n*n}(this,t):r(this)}negate(t=this){var e,i;return i=t,(e=this)[0]=-i[0],e[1]=-i[1],e[2]=-i[2],this}cross(t,e){return e?l(this,t,e):l(this,this,t),this}scale(t){return n(this,this,t),this}normalize(){return o(this,this),this}dot(t){return a(this,t)}equals(t){return i=t,(e=this)[0]===i[0]&&e[1]===i[1]&&e[2]===i[2];var e,i}applyMatrix3(t){return function(t,e,i){let s=e[0],n=e[1],r=e[2];t[0]=s*i[0]+n*i[3]+r*i[6],t[1]=s*i[1]+n*i[4]+r*i[7],t[2]=s*i[2]+n*i[5]+r*i[8]}(this,this,t),this}applyMatrix4(t){return function(t,e,i){let s=e[0],n=e[1],r=e[2],o=i[3]*s+i[7]*n+i[11]*r+i[15];o=o||1,t[0]=(i[0]*s+i[4]*n+i[8]*r+i[12])/o,t[1]=(i[1]*s+i[5]*n+i[9]*r+i[13])/o,t[2]=(i[2]*s+i[6]*n+i[10]*r+i[14])/o}(this,this,t),this}scaleRotateMatrix4(t){return function(t,e,i){let s=e[0],n=e[1],r=e[2],o=i[3]*s+i[7]*n+i[11]*r+i[15];o=o||1,t[0]=(i[0]*s+i[4]*n+i[8]*r)/o,t[1]=(i[1]*s+i[5]*n+i[9]*r)/o,t[2]=(i[2]*s+i[6]*n+i[10]*r)/o}(this,this,t),this}applyQuaternion(t){return function(t,e,i){let s=e[0],n=e[1],r=e[2],o=i[0],a=i[1],l=i[2],h=a*r-l*n,p=l*s-o*r,c=o*n-a*s,u=a*c-l*p,d=l*h-o*c,v=o*p-a*h,m=2*i[3];h*=m,p*=m,c*=m,u*=2,d*=2,v*=2,t[0]=s+h+u,t[1]=n+p+d,t[2]=r+c+v}(this,this,t),this}angle(t){return h(this,t)}lerp(t,e){return function(t,e,i,s){let n=e[0],r=e[1],o=e[2];t[0]=n+s*(i[0]-n),t[1]=r+s*(i[1]-r),t[2]=o+s*(i[2]-o)}(this,this,t,e),this}smoothLerp(t,e,i){return function(t,e,i,s,n){const r=Math.exp(-s*n);let o=e[0],a=e[1],l=e[2];t[0]=i[0]+(o-i[0])*r,t[1]=i[1]+(a-i[1])*r,t[2]=i[2]+(l-i[2])*r}(this,this,t,e,i),this}clone(){return new p(this[0],this[1],this[2])}fromArray(t,e=0){return this[0]=t[e],this[1]=t[e+1],this[2]=t[e+2],this}toArray(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t}transformDirection(t){const e=this[0],i=this[1],s=this[2];return this[0]=t[0]*e+t[4]*i+t[8]*s,this[1]=t[1]*e+t[5]*i+t[9]*s,this[2]=t[2]*e+t[6]*i+t[10]*s,this.normalize()}}const c=new p;let u=1,d=1,v=!1;class m{constructor(t,e={}){t.canvas||console.error("gl not passed as first argument to Geometry"),this.gl=t,this.attributes=e,this.id=u++,this.VAOs={},this.drawRange={start:0,count:0},this.instancedCount=0,this.gl.renderer.bindVertexArray(null),this.gl.renderer.currentGeometry=null,this.glState=this.gl.renderer.state;for(let t in e)this.addAttribute(t,e[t])}addAttribute(t,e){if(this.attributes[t]=e,e.id=d++,e.size=e.size||1,e.type=e.type||(e.data.constructor===Float32Array?this.gl.FLOAT:e.data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT),e.target="index"===t?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,e.normalized=e.normalized||!1,e.stride=e.stride||0,e.offset=e.offset||0,e.count=e.count||(e.stride?e.data.byteLength/e.stride:e.data.length/e.size),e.divisor=e.instanced||0,e.needsUpdate=!1,e.usage=e.usage||this.gl.STATIC_DRAW,e.buffer||this.updateAttribute(e),e.divisor){if(this.isInstanced=!0,this.instancedCount&&this.instancedCount!==e.count*e.divisor)return console.warn("geometry has multiple instanced buffers of different length"),this.instancedCount=Math.min(this.instancedCount,e.count*e.divisor);this.instancedCount=e.count*e.divisor}else"index"===t?this.drawRange.count=e.count:this.attributes.index||(this.drawRange.count=Math.max(this.drawRange.count,e.count))}updateAttribute(t){const e=!t.buffer;e&&(t.buffer=this.gl.createBuffer()),this.glState.boundBuffer!==t.buffer&&(this.gl.bindBuffer(t.target,t.buffer),this.glState.boundBuffer=t.buffer),e?this.gl.bufferData(t.target,t.data,t.usage):this.gl.bufferSubData(t.target,0,t.data),t.needsUpdate=!1}setIndex(t){this.addAttribute("index",t)}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}setInstancedCount(t){this.instancedCount=t}createVAO(t){this.VAOs[t.attributeOrder]=this.gl.renderer.createVertexArray(),this.gl.renderer.bindVertexArray(this.VAOs[t.attributeOrder]),this.bindAttributes(t)}bindAttributes(t){t.attributeLocations.forEach((t,{name:e,type:i})=>{if(!this.attributes[e])return void console.warn(`active attribute ${e} not being supplied`);const s=this.attributes[e];this.gl.bindBuffer(s.target,s.buffer),this.glState.boundBuffer=s.buffer;let n=1;35674===i&&(n=2),35675===i&&(n=3),35676===i&&(n=4);const r=s.size/n,o=1===n?0:n*n*4,a=1===n?0:4*n;for(let e=0;e<n;e++)this.gl.vertexAttribPointer(t+e,r,s.type,s.normalized,s.stride+o,s.offset+e*a),this.gl.enableVertexAttribArray(t+e),this.gl.renderer.vertexAttribDivisor(t+e,s.divisor)}),this.attributes.index&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.attributes.index.buffer)}draw({program:t,mode:e=this.gl.TRIANGLES}){this.gl.renderer.currentGeometry!==`${this.id}_${t.attributeOrder}`&&(this.VAOs[t.attributeOrder]||this.createVAO(t),this.gl.renderer.bindVertexArray(this.VAOs[t.attributeOrder]),this.gl.renderer.currentGeometry=`${this.id}_${t.attributeOrder}`),t.attributeLocations.forEach((t,{name:e})=>{const i=this.attributes[e];i.needsUpdate&&this.updateAttribute(i)});let i=2;this.attributes.index?.type===this.gl.UNSIGNED_INT&&(i=4),this.isInstanced?this.attributes.index?this.gl.renderer.drawElementsInstanced(e,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*i,this.instancedCount):this.gl.renderer.drawArraysInstanced(e,this.drawRange.start,this.drawRange.count,this.instancedCount):this.attributes.index?this.gl.drawElements(e,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*i):this.gl.drawArrays(e,this.drawRange.start,this.drawRange.count)}getPosition(){const t=this.attributes.position;return t.data?t:v?void 0:(console.warn("No position buffer data found to compute bounds"),v=!0)}computeBoundingBox(t){t||(t=this.getPosition());const e=t.data,i=t.size;this.bounds||(this.bounds={min:new p,max:new p,center:new p,scale:new p,radius:1/0});const s=this.bounds.min,n=this.bounds.max,r=this.bounds.center,o=this.bounds.scale;s.set(1/0),n.set(-1/0);for(let t=0,r=e.length;t<r;t+=i){const i=e[t],r=e[t+1],o=e[t+2];s.x=Math.min(i,s.x),s.y=Math.min(r,s.y),s.z=Math.min(o,s.z),n.x=Math.max(i,n.x),n.y=Math.max(r,n.y),n.z=Math.max(o,n.z)}o.sub(n,s),r.add(s,n).divide(2)}computeBoundingSphere(t){t||(t=this.getPosition());const e=t.data,i=t.size;this.bounds||this.computeBoundingBox(t);let s=0;for(let t=0,n=e.length;t<n;t+=i)c.fromArray(e,t),s=Math.max(s,this.bounds.center.squaredDistance(c));this.bounds.radius=Math.sqrt(s)}remove(){for(let t in this.VAOs)this.gl.renderer.deleteVertexArray(this.VAOs[t]),delete this.VAOs[t];for(let t in this.attributes)this.gl.deleteBuffer(this.attributes[t].buffer),delete this.attributes[t]}}let g=1;const b={};class f{constructor(t,{vertex:e,fragment:i,uniforms:s={},transparent:n=!1,cullFace:r=t.BACK,frontFace:o=t.CCW,depthTest:a=!0,depthWrite:l=!0,depthFunc:h=t.LEQUAL}={}){t.canvas||console.error("gl not passed as first argument to Program"),this.gl=t,this.uniforms=s,this.id=g++,e||console.warn("vertex shader not supplied"),i||console.warn("fragment shader not supplied"),this.transparent=n,this.cullFace=r,this.frontFace=o,this.depthTest=a,this.depthWrite=l,this.depthFunc=h,this.blendFunc={},this.blendEquation={},this.stencilFunc={},this.stencilOp={},this.transparent&&!this.blendFunc.src&&(this.gl.renderer.premultipliedAlpha?this.setBlendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA):this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)),this.vertexShader=t.createShader(t.VERTEX_SHADER),this.fragmentShader=t.createShader(t.FRAGMENT_SHADER),this.program=t.createProgram(),t.attachShader(this.program,this.vertexShader),t.attachShader(this.program,this.fragmentShader),this.setShaders({vertex:e,fragment:i})}setShaders({vertex:t,fragment:e}){if(t&&(this.gl.shaderSource(this.vertexShader,t),this.gl.compileShader(this.vertexShader),""!==this.gl.getShaderInfoLog(this.vertexShader)&&console.warn(`${this.gl.getShaderInfoLog(this.vertexShader)}\nVertex Shader\n${w(t)}`)),e&&(this.gl.shaderSource(this.fragmentShader,e),this.gl.compileShader(this.fragmentShader),""!==this.gl.getShaderInfoLog(this.fragmentShader)&&console.warn(`${this.gl.getShaderInfoLog(this.fragmentShader)}\nFragment Shader\n${w(e)}`)),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))return console.warn(this.gl.getProgramInfoLog(this.program));this.uniformLocations=new Map;let i=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_UNIFORMS);for(let t=0;t<i;t++){let e=this.gl.getActiveUniform(this.program,t);this.uniformLocations.set(e,this.gl.getUniformLocation(this.program,e.name));const i=e.name.match(/(\w+)/g);e.uniformName=i[0],e.nameComponents=i.slice(1)}this.attributeLocations=new Map;const s=[],n=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);for(let t=0;t<n;t++){const e=this.gl.getActiveAttrib(this.program,t),i=this.gl.getAttribLocation(this.program,e.name);-1!==i&&(s[i]=e.name,this.attributeLocations.set(e,i))}this.attributeOrder=s.join("")}setBlendFunc(t,e,i,s){this.blendFunc.src=t,this.blendFunc.dst=e,this.blendFunc.srcAlpha=i,this.blendFunc.dstAlpha=s,t&&(this.transparent=!0)}setBlendEquation(t,e){this.blendEquation.modeRGB=t,this.blendEquation.modeAlpha=e}setStencilFunc(t,e,i){this.stencilRef=e,this.stencilFunc.func=t,this.stencilFunc.ref=e,this.stencilFunc.mask=i}setStencilOp(t,e,i){this.stencilOp.stencilFail=t,this.stencilOp.depthFail=e,this.stencilOp.depthPass=i}applyState(){this.depthTest?this.gl.renderer.enable(this.gl.DEPTH_TEST):this.gl.renderer.disable(this.gl.DEPTH_TEST),this.cullFace?this.gl.renderer.enable(this.gl.CULL_FACE):this.gl.renderer.disable(this.gl.CULL_FACE),this.blendFunc.src?this.gl.renderer.enable(this.gl.BLEND):this.gl.renderer.disable(this.gl.BLEND),this.cullFace&&this.gl.renderer.setCullFace(this.cullFace),this.gl.renderer.setFrontFace(this.frontFace),this.gl.renderer.setDepthMask(this.depthWrite),this.gl.renderer.setDepthFunc(this.depthFunc),this.blendFunc.src&&this.gl.renderer.setBlendFunc(this.blendFunc.src,this.blendFunc.dst,this.blendFunc.srcAlpha,this.blendFunc.dstAlpha),this.gl.renderer.setBlendEquation(this.blendEquation.modeRGB,this.blendEquation.modeAlpha),this.stencilFunc.func||this.stencilOp.stencilFail?this.gl.renderer.enable(this.gl.STENCIL_TEST):this.gl.renderer.disable(this.gl.STENCIL_TEST),this.gl.renderer.setStencilFunc(this.stencilFunc.func,this.stencilFunc.ref,this.stencilFunc.mask),this.gl.renderer.setStencilOp(this.stencilOp.stencilFail,this.stencilOp.depthFail,this.stencilOp.depthPass)}use({flipFaces:t=!1}={}){let e=-1;this.gl.renderer.state.currentProgram===this.id||(this.gl.useProgram(this.program),this.gl.renderer.state.currentProgram=this.id),this.uniformLocations.forEach((t,i)=>{let s=this.uniforms[i.uniformName];for(const t of i.nameComponents){if(!s)break;if(!(t in s)){if(Array.isArray(s.value))break;s=void 0;break}s=s[t]}if(!s)return y(`Active uniform ${i.name} has not been supplied`);if(s&&void 0===s.value)return y(`${i.name} uniform is missing a value parameter`);if(s.value.texture)return e+=1,s.value.update(e),_(this.gl,i.type,t,e);if(s.value.length&&s.value[0].texture){const n=[];return s.value.forEach(t=>{e+=1,t.update(e),n.push(e)}),_(this.gl,i.type,t,n)}_(this.gl,i.type,t,s.value)}),this.applyState(),t&&this.gl.renderer.setFrontFace(this.frontFace===this.gl.CCW?this.gl.CW:this.gl.CCW)}remove(){this.gl.deleteProgram(this.program)}}function _(t,e,i,s){s=s.length?function(t){const e=t.length,i=t[0].length;if(void 0===i)return t;const s=e*i;let n=b[s];n||(b[s]=n=new Float32Array(s));for(let s=0;s<e;s++)n.set(t[s],s*i);return n}(s):s;const n=t.renderer.state.uniformLocations.get(i);if(s.length)if(void 0===n||n.length!==s.length)t.renderer.state.uniformLocations.set(i,s.slice(0));else{if(function(t,e){if(t.length!==e.length)return!1;for(let i=0,s=t.length;i<s;i++)if(t[i]!==e[i])return!1;return!0}(n,s))return;n.set?n.set(s):function(t,e){for(let i=0,s=t.length;i<s;i++)t[i]=e[i]}(n,s),t.renderer.state.uniformLocations.set(i,n)}else{if(n===s)return;t.renderer.state.uniformLocations.set(i,s)}switch(e){case 5126:return s.length?t.uniform1fv(i,s):t.uniform1f(i,s);case 35664:return t.uniform2fv(i,s);case 35665:return t.uniform3fv(i,s);case 35666:return t.uniform4fv(i,s);case 35670:case 5124:case 35678:case 36306:case 35680:case 36289:return s.length?t.uniform1iv(i,s):t.uniform1i(i,s);case 35671:case 35667:return t.uniform2iv(i,s);case 35672:case 35668:return t.uniform3iv(i,s);case 35673:case 35669:return t.uniform4iv(i,s);case 35674:return t.uniformMatrix2fv(i,!1,s);case 35675:return t.uniformMatrix3fv(i,!1,s);case 35676:return t.uniformMatrix4fv(i,!1,s)}}function w(t){let e=t.split("\n");for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join("\n")}let x=0;function y(t){x>100||(console.warn(t),x++,x>100&&console.warn("More than 100 program warnings - stopping logs."))}const C=new p;let E=1;class P{constructor({canvas:t=document.createElement("canvas"),width:e=300,height:i=150,dpr:s=1,alpha:n=!1,depth:r=!0,stencil:o=!1,antialias:a=!1,premultipliedAlpha:l=!1,preserveDrawingBuffer:h=!1,powerPreference:p="default",autoClear:c=!0,webgl:u=2}={}){const d={alpha:n,depth:r,stencil:o,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:h,powerPreference:p};this.dpr=s,this.alpha=n,this.color=!0,this.depth=r,this.stencil=o,this.premultipliedAlpha=l,this.autoClear=c,this.id=E++,2===u&&(this.gl=t.getContext("webgl2",d)),this.isWebgl2=!!this.gl,this.gl||(this.gl=t.getContext("webgl",d)),this.gl||console.error("unable to create webgl context"),this.gl.renderer=this,this.setSize(e,i),this.state={},this.state.blendFunc={src:this.gl.ONE,dst:this.gl.ZERO},this.state.blendEquation={modeRGB:this.gl.FUNC_ADD},this.state.cullFace=!1,this.state.frontFace=this.gl.CCW,this.state.depthMask=!0,this.state.depthFunc=this.gl.LEQUAL,this.state.premultiplyAlpha=!1,this.state.flipY=!1,this.state.unpackAlignment=4,this.state.framebuffer=null,this.state.viewport={x:0,y:0,width:null,height:null},this.state.textureUnits=[],this.state.activeTextureUnit=0,this.state.boundBuffer=null,this.state.uniformLocations=new Map,this.state.currentProgram=null,this.extensions={},this.isWebgl2?(this.getExtension("EXT_color_buffer_float"),this.getExtension("OES_texture_float_linear")):(this.getExtension("OES_texture_float"),this.getExtension("OES_texture_float_linear"),this.getExtension("OES_texture_half_float"),this.getExtension("OES_texture_half_float_linear"),this.getExtension("OES_element_index_uint"),this.getExtension("OES_standard_derivatives"),this.getExtension("EXT_sRGB"),this.getExtension("WEBGL_depth_texture"),this.getExtension("WEBGL_draw_buffers")),this.getExtension("WEBGL_compressed_texture_astc"),this.getExtension("EXT_texture_compression_bptc"),this.getExtension("WEBGL_compressed_texture_s3tc"),this.getExtension("WEBGL_compressed_texture_etc1"),this.getExtension("WEBGL_compressed_texture_pvrtc"),this.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),this.vertexAttribDivisor=this.getExtension("ANGLE_instanced_arrays","vertexAttribDivisor","vertexAttribDivisorANGLE"),this.drawArraysInstanced=this.getExtension("ANGLE_instanced_arrays","drawArraysInstanced","drawArraysInstancedANGLE"),this.drawElementsInstanced=this.getExtension("ANGLE_instanced_arrays","drawElementsInstanced","drawElementsInstancedANGLE"),this.createVertexArray=this.getExtension("OES_vertex_array_object","createVertexArray","createVertexArrayOES"),this.bindVertexArray=this.getExtension("OES_vertex_array_object","bindVertexArray","bindVertexArrayOES"),this.deleteVertexArray=this.getExtension("OES_vertex_array_object","deleteVertexArray","deleteVertexArrayOES"),this.drawBuffers=this.getExtension("WEBGL_draw_buffers","drawBuffers","drawBuffersWEBGL"),this.parameters={},this.parameters.maxTextureUnits=this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.parameters.maxAnisotropy=this.getExtension("EXT_texture_filter_anisotropic")?this.gl.getParameter(this.getExtension("EXT_texture_filter_anisotropic").MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}setSize(t,e){this.width=t,this.height=e,this.gl.canvas.width=t*this.dpr,this.gl.canvas.height=e*this.dpr,this.gl.canvas.style&&Object.assign(this.gl.canvas.style,{width:t+"px",height:e+"px"})}setViewport(t,e,i=0,s=0){this.state.viewport.width===t&&this.state.viewport.height===e||(this.state.viewport.width=t,this.state.viewport.height=e,this.state.viewport.x=i,this.state.viewport.y=s,this.gl.viewport(i,s,t,e))}setScissor(t,e,i=0,s=0){this.gl.scissor(i,s,t,e)}enable(t){!0!==this.state[t]&&(this.gl.enable(t),this.state[t]=!0)}disable(t){!1!==this.state[t]&&(this.gl.disable(t),this.state[t]=!1)}setBlendFunc(t,e,i,s){this.state.blendFunc.src===t&&this.state.blendFunc.dst===e&&this.state.blendFunc.srcAlpha===i&&this.state.blendFunc.dstAlpha===s||(this.state.blendFunc.src=t,this.state.blendFunc.dst=e,this.state.blendFunc.srcAlpha=i,this.state.blendFunc.dstAlpha=s,void 0!==i?this.gl.blendFuncSeparate(t,e,i,s):this.gl.blendFunc(t,e))}setBlendEquation(t,e){t=t||this.gl.FUNC_ADD,this.state.blendEquation.modeRGB===t&&this.state.blendEquation.modeAlpha===e||(this.state.blendEquation.modeRGB=t,this.state.blendEquation.modeAlpha=e,void 0!==e?this.gl.blendEquationSeparate(t,e):this.gl.blendEquation(t))}setCullFace(t){this.state.cullFace!==t&&(this.state.cullFace=t,this.gl.cullFace(t))}setFrontFace(t){this.state.frontFace!==t&&(this.state.frontFace=t,this.gl.frontFace(t))}setDepthMask(t){this.state.depthMask!==t&&(this.state.depthMask=t,this.gl.depthMask(t))}setDepthFunc(t){this.state.depthFunc!==t&&(this.state.depthFunc=t,this.gl.depthFunc(t))}setStencilMask(t){this.state.stencilMask!==t&&(this.state.stencilMask=t,this.gl.stencilMask(t))}setStencilFunc(t,e,i){this.state.stencilFunc===t&&this.state.stencilRef===e&&this.state.stencilFuncMask===i||(this.state.stencilFunc=t||this.gl.ALWAYS,this.state.stencilRef=e||0,this.state.stencilFuncMask=i||0,this.gl.stencilFunc(t||this.gl.ALWAYS,e||0,i||0))}setStencilOp(t,e,i){this.state.stencilFail===t&&this.state.stencilDepthFail===e&&this.state.stencilDepthPass===i||(this.state.stencilFail=t,this.state.stencilDepthFail=e,this.state.stencilDepthPass=i,this.gl.stencilOp(t,e,i))}activeTexture(t){this.state.activeTextureUnit!==t&&(this.state.activeTextureUnit=t,this.gl.activeTexture(this.gl.TEXTURE0+t))}bindFramebuffer({target:t=this.gl.FRAMEBUFFER,buffer:e=null}={}){this.state.framebuffer!==e&&(this.state.framebuffer=e,this.gl.bindFramebuffer(t,e))}getExtension(t,e,i){return e&&this.gl[e]?this.gl[e].bind(this.gl):(this.extensions[t]||(this.extensions[t]=this.gl.getExtension(t)),e?this.extensions[t]?this.extensions[t][i].bind(this.extensions[t]):null:this.extensions[t])}sortOpaque(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program.id!==e.program.id?t.program.id-e.program.id:t.zDepth!==e.zDepth?t.zDepth-e.zDepth:e.id-t.id}sortTransparent(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.zDepth!==e.zDepth?e.zDepth-t.zDepth:e.id-t.id}sortUI(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program.id!==e.program.id?t.program.id-e.program.id:e.id-t.id}getRenderList({scene:t,camera:e,frustumCull:i,sort:s}){let n=[];if(e&&i&&e.updateFrustum(),t.traverse(t=>{if(!t.visible)return!0;t.draw&&(i&&t.frustumCulled&&e&&!e.frustumIntersectsMesh(t)||n.push(t))}),s){const t=[],i=[],s=[];n.forEach(n=>{n.program.transparent?n.program.depthTest?i.push(n):s.push(n):t.push(n),n.zDepth=0,0===n.renderOrder&&n.program.depthTest&&e&&(n.worldMatrix.getTranslation(C),C.applyMatrix4(e.projectionViewMatrix),n.zDepth=C.z)}),t.sort(this.sortOpaque),i.sort(this.sortTransparent),s.sort(this.sortUI),n=t.concat(i,s)}return n}render({scene:t,camera:e,target:i=null,update:s=!0,sort:n=!0,frustumCull:r=!0,clear:o}){null===i?(this.bindFramebuffer(),this.setViewport(this.width*this.dpr,this.height*this.dpr)):(this.bindFramebuffer(i),this.setViewport(i.width,i.height)),(o||this.autoClear&&!1!==o)&&(!this.depth||i&&!i.depth||(this.enable(this.gl.DEPTH_TEST),this.setDepthMask(!0)),(this.stencil||!i||i.stencil)&&(this.enable(this.gl.STENCIL_TEST),this.setStencilMask(255)),this.gl.clear((this.color?this.gl.COLOR_BUFFER_BIT:0)|(this.depth?this.gl.DEPTH_BUFFER_BIT:0)|(this.stencil?this.gl.STENCIL_BUFFER_BIT:0))),s&&t.updateMatrixWorld(),e&&e.updateMatrixWorld();this.getRenderList({scene:t,camera:e,frustumCull:r,sort:n}).forEach(t=>{t.draw({camera:e})})}}function k(t,e,i){let s=e[0],n=e[1],r=e[2],o=e[3],a=i[0],l=i[1],h=i[2],p=i[3];return t[0]=s*p+o*a+n*h-r*l,t[1]=n*p+o*l+r*a-s*h,t[2]=r*p+o*h+s*l-n*a,t[3]=o*p-s*a-n*l-r*h,t}const M=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},V=function(t,e,i,s,n){return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t},A=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},S=function(t,e){let i=e[0],s=e[1],n=e[2],r=e[3],o=i*i+s*s+n*n+r*r;return o>0&&(o=1/Math.sqrt(o)),t[0]=i*o,t[1]=s*o,t[2]=n*o,t[3]=r*o,t};class T extends Array{constructor(t=0,e=0,i=0,s=1){super(t,e,i,s),this.onChange=()=>{},this._target=this;const n=["0","1","2","3"];return new Proxy(this,{set(t,e){const i=Reflect.set(...arguments);return i&&n.includes(e)&&t.onChange(),i}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}get w(){return this[3]}set x(t){this._target[0]=t,this.onChange()}set y(t){this._target[1]=t,this.onChange()}set z(t){this._target[2]=t,this.onChange()}set w(t){this._target[3]=t,this.onChange()}identity(){var t;return(t=this._target)[0]=0,t[1]=0,t[2]=0,t[3]=1,this.onChange(),this}set(t,e,i,s){return t.length?this.copy(t):(V(this._target,t,e,i,s),this.onChange(),this)}rotateX(t){return function(t,e,i){i*=.5;let s=e[0],n=e[1],r=e[2],o=e[3],a=Math.sin(i),l=Math.cos(i);t[0]=s*l+o*a,t[1]=n*l+r*a,t[2]=r*l-n*a,t[3]=o*l-s*a}(this._target,this._target,t),this.onChange(),this}rotateY(t){return function(t,e,i){i*=.5;let s=e[0],n=e[1],r=e[2],o=e[3],a=Math.sin(i),l=Math.cos(i);t[0]=s*l-r*a,t[1]=n*l+o*a,t[2]=r*l+s*a,t[3]=o*l-n*a}(this._target,this._target,t),this.onChange(),this}rotateZ(t){return function(t,e,i){i*=.5;let s=e[0],n=e[1],r=e[2],o=e[3],a=Math.sin(i),l=Math.cos(i);t[0]=s*l+n*a,t[1]=n*l-s*a,t[2]=r*l+o*a,t[3]=o*l-r*a}(this._target,this._target,t),this.onChange(),this}inverse(t=this._target){return function(t,e){let i=e[0],s=e[1],n=e[2],r=e[3],o=i*i+s*s+n*n+r*r,a=o?1/o:0;t[0]=-i*a,t[1]=-s*a,t[2]=-n*a,t[3]=r*a}(this._target,t),this.onChange(),this}conjugate(t=this._target){var e,i;return e=this._target,i=t,e[0]=-i[0],e[1]=-i[1],e[2]=-i[2],e[3]=i[3],this.onChange(),this}copy(t){return M(this._target,t),this.onChange(),this}normalize(t=this._target){return S(this._target,t),this.onChange(),this}multiply(t,e){return e?k(this._target,t,e):k(this._target,this._target,t),this.onChange(),this}dot(t){return A(this._target,t)}fromMatrix3(t){return function(t,e){let i,s=e[0]+e[4]+e[8];if(s>0)i=Math.sqrt(s+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{let s=0;e[4]>e[0]&&(s=1),e[8]>e[3*s+s]&&(s=2);let n=(s+1)%3,r=(s+2)%3;i=Math.sqrt(e[3*s+s]-e[3*n+n]-e[3*r+r]+1),t[s]=.5*i,i=.5/i,t[3]=(e[3*n+r]-e[3*r+n])*i,t[n]=(e[3*n+s]+e[3*s+n])*i,t[r]=(e[3*r+s]+e[3*s+r])*i}}(this._target,t),this.onChange(),this}fromEuler(t,e){return function(t,e,i="YXZ"){let s=Math.sin(.5*e[0]),n=Math.cos(.5*e[0]),r=Math.sin(.5*e[1]),o=Math.cos(.5*e[1]),a=Math.sin(.5*e[2]),l=Math.cos(.5*e[2]);"XYZ"===i?(t[0]=s*o*l+n*r*a,t[1]=n*r*l-s*o*a,t[2]=n*o*a+s*r*l,t[3]=n*o*l-s*r*a):"YXZ"===i?(t[0]=s*o*l+n*r*a,t[1]=n*r*l-s*o*a,t[2]=n*o*a-s*r*l,t[3]=n*o*l+s*r*a):"ZXY"===i?(t[0]=s*o*l-n*r*a,t[1]=n*r*l+s*o*a,t[2]=n*o*a+s*r*l,t[3]=n*o*l-s*r*a):"ZYX"===i?(t[0]=s*o*l-n*r*a,t[1]=n*r*l+s*o*a,t[2]=n*o*a-s*r*l,t[3]=n*o*l+s*r*a):"YZX"===i?(t[0]=s*o*l+n*r*a,t[1]=n*r*l+s*o*a,t[2]=n*o*a-s*r*l,t[3]=n*o*l-s*r*a):"XZY"===i&&(t[0]=s*o*l-n*r*a,t[1]=n*r*l-s*o*a,t[2]=n*o*a+s*r*l,t[3]=n*o*l+s*r*a)}(this._target,t,t.order),e||this.onChange(),this}fromAxisAngle(t,e){return function(t,e,i){i*=.5;let s=Math.sin(i);t[0]=s*e[0],t[1]=s*e[1],t[2]=s*e[2],t[3]=Math.cos(i)}(this._target,t,e),this.onChange(),this}slerp(t,e){return function(t,e,i,s){let n,r,o,a,l,h=e[0],p=e[1],c=e[2],u=e[3],d=i[0],v=i[1],m=i[2],g=i[3];r=h*d+p*v+c*m+u*g,r<0&&(r=-r,d=-d,v=-v,m=-m,g=-g),1-r>1e-6?(n=Math.acos(r),o=Math.sin(n),a=Math.sin((1-s)*n)/o,l=Math.sin(s*n)/o):(a=1-s,l=s),t[0]=a*h+l*d,t[1]=a*p+l*v,t[2]=a*c+l*m,t[3]=a*u+l*g}(this._target,this._target,t,e),this.onChange(),this}fromArray(t,e=0){return this._target[0]=t[e],this._target[1]=t[e+1],this._target[2]=t[e+2],this._target[3]=t[e+3],this.onChange(),this}toArray(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t[e+3]=this[3],t}}function L(t){let e=t[0],i=t[1],s=t[2],n=t[3],r=t[4],o=t[5],a=t[6],l=t[7],h=t[8],p=t[9],c=t[10],u=t[11],d=t[12],v=t[13],m=t[14],g=t[15];return(e*o-i*r)*(c*g-u*m)-(e*a-s*r)*(p*g-u*v)+(e*l-n*r)*(p*m-c*v)+(i*a-s*o)*(h*g-u*d)-(i*l-n*o)*(h*m-c*d)+(s*l-n*a)*(h*v-p*d)}function R(t,e,i){let s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],h=e[6],p=e[7],c=e[8],u=e[9],d=e[10],v=e[11],m=e[12],g=e[13],b=e[14],f=e[15],_=i[0],w=i[1],x=i[2],y=i[3];return t[0]=_*s+w*a+x*c+y*m,t[1]=_*n+w*l+x*u+y*g,t[2]=_*r+w*h+x*d+y*b,t[3]=_*o+w*p+x*v+y*f,_=i[4],w=i[5],x=i[6],y=i[7],t[4]=_*s+w*a+x*c+y*m,t[5]=_*n+w*l+x*u+y*g,t[6]=_*r+w*h+x*d+y*b,t[7]=_*o+w*p+x*v+y*f,_=i[8],w=i[9],x=i[10],y=i[11],t[8]=_*s+w*a+x*c+y*m,t[9]=_*n+w*l+x*u+y*g,t[10]=_*r+w*h+x*d+y*b,t[11]=_*o+w*p+x*v+y*f,_=i[12],w=i[13],x=i[14],y=i[15],t[12]=_*s+w*a+x*c+y*m,t[13]=_*n+w*l+x*u+y*g,t[14]=_*r+w*h+x*d+y*b,t[15]=_*o+w*p+x*v+y*f,t}function D(t,e){let i=e[0],s=e[1],n=e[2],r=e[4],o=e[5],a=e[6],l=e[8],h=e[9],p=e[10];return t[0]=Math.hypot(i,s,n),t[1]=Math.hypot(r,o,a),t[2]=Math.hypot(l,h,p),t}const F=function(){const t=[1,1,1];return function(e,i){let s=t;D(s,i);let n=1/s[0],r=1/s[1],o=1/s[2],a=i[0]*n,l=i[1]*r,h=i[2]*o,p=i[4]*n,c=i[5]*r,u=i[6]*o,d=i[8]*n,v=i[9]*r,m=i[10]*o,g=a+c+m,b=0;return g>0?(b=2*Math.sqrt(g+1),e[3]=.25*b,e[0]=(u-v)/b,e[1]=(d-h)/b,e[2]=(l-p)/b):a>c&&a>m?(b=2*Math.sqrt(1+a-c-m),e[3]=(u-v)/b,e[0]=.25*b,e[1]=(l+p)/b,e[2]=(d+h)/b):c>m?(b=2*Math.sqrt(1+c-a-m),e[3]=(d-h)/b,e[0]=(l+p)/b,e[1]=.25*b,e[2]=(u+v)/b):(b=2*Math.sqrt(1+m-a-c),e[3]=(l-p)/b,e[0]=(d+h)/b,e[1]=(u+v)/b,e[2]=.25*b),e}}();function O(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t[9]=e[9]+i[9],t[10]=e[10]+i[10],t[11]=e[11]+i[11],t[12]=e[12]+i[12],t[13]=e[13]+i[13],t[14]=e[14]+i[14],t[15]=e[15]+i[15],t}function N(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t[9]=e[9]-i[9],t[10]=e[10]-i[10],t[11]=e[11]-i[11],t[12]=e[12]-i[12],t[13]=e[13]-i[13],t[14]=e[14]-i[14],t[15]=e[15]-i[15],t}class B extends Array{constructor(t=1,e=0,i=0,s=0,n=0,r=1,o=0,a=0,l=0,h=0,p=1,c=0,u=0,d=0,v=0,m=1){return super(t,e,i,s,n,r,o,a,l,h,p,c,u,d,v,m),this}get x(){return this[12]}get y(){return this[13]}get z(){return this[14]}get w(){return this[15]}set x(t){this[12]=t}set y(t){this[13]=t}set z(t){this[14]=t}set w(t){this[15]=t}set(t,e,i,s,n,r,o,a,l,h,p,c,u,d,v,m){return t.length?this.copy(t):(function(t,e,i,s,n,r,o,a,l,h,p,c,u,d,v,m,g){t[0]=e,t[1]=i,t[2]=s,t[3]=n,t[4]=r,t[5]=o,t[6]=a,t[7]=l,t[8]=h,t[9]=p,t[10]=c,t[11]=u,t[12]=d,t[13]=v,t[14]=m,t[15]=g}(this,t,e,i,s,n,r,o,a,l,h,p,c,u,d,v,m),this)}translate(t,e=this){return function(t,e,i){let s,n,r,o,a,l,h,p,c,u,d,v,m=i[0],g=i[1],b=i[2];e===t?(t[12]=e[0]*m+e[4]*g+e[8]*b+e[12],t[13]=e[1]*m+e[5]*g+e[9]*b+e[13],t[14]=e[2]*m+e[6]*g+e[10]*b+e[14],t[15]=e[3]*m+e[7]*g+e[11]*b+e[15]):(s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],h=e[6],p=e[7],c=e[8],u=e[9],d=e[10],v=e[11],t[0]=s,t[1]=n,t[2]=r,t[3]=o,t[4]=a,t[5]=l,t[6]=h,t[7]=p,t[8]=c,t[9]=u,t[10]=d,t[11]=v,t[12]=s*m+a*g+c*b+e[12],t[13]=n*m+l*g+u*b+e[13],t[14]=r*m+h*g+d*b+e[14],t[15]=o*m+p*g+v*b+e[15])}(this,e,t),this}rotate(t,e,i=this){return function(t,e,i,s){let n,r,o,a,l,h,p,c,u,d,v,m,g,b,f,_,w,x,y,C,E,P,k,M,V=s[0],A=s[1],S=s[2],T=Math.hypot(V,A,S);Math.abs(T)<1e-6||(T=1/T,V*=T,A*=T,S*=T,n=Math.sin(i),r=Math.cos(i),o=1-r,a=e[0],l=e[1],h=e[2],p=e[3],c=e[4],u=e[5],d=e[6],v=e[7],m=e[8],g=e[9],b=e[10],f=e[11],_=V*V*o+r,w=A*V*o+S*n,x=S*V*o-A*n,y=V*A*o-S*n,C=A*A*o+r,E=S*A*o+V*n,P=V*S*o+A*n,k=A*S*o-V*n,M=S*S*o+r,t[0]=a*_+c*w+m*x,t[1]=l*_+u*w+g*x,t[2]=h*_+d*w+b*x,t[3]=p*_+v*w+f*x,t[4]=a*y+c*C+m*E,t[5]=l*y+u*C+g*E,t[6]=h*y+d*C+b*E,t[7]=p*y+v*C+f*E,t[8]=a*P+c*k+m*M,t[9]=l*P+u*k+g*M,t[10]=h*P+d*k+b*M,t[11]=p*P+v*k+f*M,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}(this,i,t,e),this}scale(t,e=this){return function(t,e,i){let s=i[0],n=i[1],r=i[2];t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(this,e,"number"==typeof t?[t,t,t]:t),this}add(t,e){return e?O(this,t,e):O(this,this,t),this}sub(t,e){return e?N(this,t,e):N(this,this,t),this}multiply(t,e){var i,s,n;return t.length?e?R(this,t,e):R(this,this,t):(s=this,n=t,(i=this)[0]=s[0]*n,i[1]=s[1]*n,i[2]=s[2]*n,i[3]=s[3]*n,i[4]=s[4]*n,i[5]=s[5]*n,i[6]=s[6]*n,i[7]=s[7]*n,i[8]=s[8]*n,i[9]=s[9]*n,i[10]=s[10]*n,i[11]=s[11]*n,i[12]=s[12]*n,i[13]=s[13]*n,i[14]=s[14]*n,i[15]=s[15]*n),this}identity(){var t;return(t=this)[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}copy(t){var e,i;return i=t,(e=this)[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this}fromPerspective({fov:t,aspect:e,near:i,far:s}={}){return function(t,e,i,s,n){let r=1/Math.tan(e/2),o=1/(s-n);t[0]=r/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(n+s)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*n*s*o,t[15]=0}(this,t,e,i,s),this}fromOrthogonal({left:t,right:e,bottom:i,top:s,near:n,far:r}){return function(t,e,i,s,n,r,o){let a=1/(e-i),l=1/(s-n),h=1/(r-o);t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+i)*a,t[13]=(n+s)*l,t[14]=(o+r)*h,t[15]=1}(this,t,e,i,s,n,r),this}fromQuaternion(t){return function(t,e){let i=e[0],s=e[1],n=e[2],r=e[3],o=i+i,a=s+s,l=n+n,h=i*o,p=s*o,c=s*a,u=n*o,d=n*a,v=n*l,m=r*o,g=r*a,b=r*l;t[0]=1-c-v,t[1]=p+b,t[2]=u-g,t[3]=0,t[4]=p-b,t[5]=1-h-v,t[6]=d+m,t[7]=0,t[8]=u+g,t[9]=d-m,t[10]=1-h-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,t),this}setPosition(t){return this.x=t[0],this.y=t[1],this.z=t[2],this}inverse(t=this){return function(t,e){let i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],h=e[7],p=e[8],c=e[9],u=e[10],d=e[11],v=e[12],m=e[13],g=e[14],b=e[15],f=i*a-s*o,_=i*l-n*o,w=i*h-r*o,x=s*l-n*a,y=s*h-r*a,C=n*h-r*l,E=p*m-c*v,P=p*g-u*v,k=p*b-d*v,M=c*g-u*m,V=c*b-d*m,A=u*b-d*g,S=f*A-_*V+w*M+x*k-y*P+C*E;S&&(S=1/S,t[0]=(a*A-l*V+h*M)*S,t[1]=(n*V-s*A-r*M)*S,t[2]=(m*C-g*y+b*x)*S,t[3]=(u*y-c*C-d*x)*S,t[4]=(l*k-o*A-h*P)*S,t[5]=(i*A-n*k+r*P)*S,t[6]=(g*w-v*C-b*_)*S,t[7]=(p*C-u*w+d*_)*S,t[8]=(o*V-a*k+h*E)*S,t[9]=(s*k-i*V-r*E)*S,t[10]=(v*y-m*w+b*f)*S,t[11]=(c*w-p*y-d*f)*S,t[12]=(a*P-o*M-l*E)*S,t[13]=(i*M-s*P+n*E)*S,t[14]=(m*_-v*x-g*f)*S,t[15]=(p*x-c*_+u*f)*S)}(this,t),this}compose(t,e,i){return function(t,e,i,s){const n=t,r=e[0],o=e[1],a=e[2],l=e[3],h=r+r,p=o+o,c=a+a,u=r*h,d=r*p,v=r*c,m=o*p,g=o*c,b=a*c,f=l*h,_=l*p,w=l*c,x=s[0],y=s[1],C=s[2];n[0]=(1-(m+b))*x,n[1]=(d+w)*x,n[2]=(v-_)*x,n[3]=0,n[4]=(d-w)*y,n[5]=(1-(u+b))*y,n[6]=(g+f)*y,n[7]=0,n[8]=(v+_)*C,n[9]=(g-f)*C,n[10]=(1-(u+m))*C,n[11]=0,n[12]=i[0],n[13]=i[1],n[14]=i[2],n[15]=1}(this,t,e,i),this}decompose(e,i,s){return function(e,i,s,n){let r=t([e[0],e[1],e[2]]);const o=t([e[4],e[5],e[6]]),a=t([e[8],e[9],e[10]]);L(e)<0&&(r=-r),s[0]=e[12],s[1]=e[13],s[2]=e[14];const l=e.slice(),h=1/r,p=1/o,c=1/a;l[0]*=h,l[1]*=h,l[2]*=h,l[4]*=p,l[5]*=p,l[6]*=p,l[8]*=c,l[9]*=c,l[10]*=c,F(i,l),n[0]=r,n[1]=o,n[2]=a}(this,e,i,s),this}getRotation(t){return F(t,this),this}getTranslation(t){var e,i;return i=this,(e=t)[0]=i[12],e[1]=i[13],e[2]=i[14],this}getScaling(t){return D(t,this),this}getMaxScaleOnAxis(){return function(t){let e=t[0],i=t[1],s=t[2],n=t[4],r=t[5],o=t[6],a=t[8],l=t[9],h=t[10];const p=e*e+i*i+s*s,c=n*n+r*r+o*o,u=a*a+l*l+h*h;return Math.sqrt(Math.max(p,c,u))}(this)}lookAt(t,e,i){return function(t,e,i,s){let n=e[0],r=e[1],o=e[2],a=s[0],l=s[1],h=s[2],p=n-i[0],c=r-i[1],u=o-i[2],d=p*p+c*c+u*u;0===d?u=1:(d=1/Math.sqrt(d),p*=d,c*=d,u*=d);let v=l*u-h*c,m=h*p-a*u,g=a*c-l*p;d=v*v+m*m+g*g,0===d&&(h?a+=1e-6:l?h+=1e-6:l+=1e-6,v=l*u-h*c,m=h*p-a*u,g=a*c-l*p,d=v*v+m*m+g*g),d=1/Math.sqrt(d),v*=d,m*=d,g*=d,t[0]=v,t[1]=m,t[2]=g,t[3]=0,t[4]=c*g-u*m,t[5]=u*v-p*g,t[6]=p*m-c*v,t[7]=0,t[8]=p,t[9]=c,t[10]=u,t[11]=0,t[12]=n,t[13]=r,t[14]=o,t[15]=1}(this,t,e,i),this}determinant(){return L(this)}fromArray(t,e=0){return this[0]=t[e],this[1]=t[e+1],this[2]=t[e+2],this[3]=t[e+3],this[4]=t[e+4],this[5]=t[e+5],this[6]=t[e+6],this[7]=t[e+7],this[8]=t[e+8],this[9]=t[e+9],this[10]=t[e+10],this[11]=t[e+11],this[12]=t[e+12],this[13]=t[e+13],this[14]=t[e+14],this[15]=t[e+15],this}toArray(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t[e+3]=this[3],t[e+4]=this[4],t[e+5]=this[5],t[e+6]=this[6],t[e+7]=this[7],t[e+8]=this[8],t[e+9]=this[9],t[e+10]=this[10],t[e+11]=this[11],t[e+12]=this[12],t[e+13]=this[13],t[e+14]=this[14],t[e+15]=this[15],t}}const j=new B;class I extends Array{constructor(t=0,e=t,i=t,s="YXZ"){super(t,e,i),this.order=s,this.onChange=()=>{},this._target=this;const n=["0","1","2"];return new Proxy(this,{set(t,e){const i=Reflect.set(...arguments);return i&&n.includes(e)&&t.onChange(),i}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(t){this._target[0]=t,this.onChange()}set y(t){this._target[1]=t,this.onChange()}set z(t){this._target[2]=t,this.onChange()}set(t,e=t,i=t){return t.length?this.copy(t):(this._target[0]=t,this._target[1]=e,this._target[2]=i,this.onChange(),this)}copy(t){return this._target[0]=t[0],this._target[1]=t[1],this._target[2]=t[2],this.onChange(),this}reorder(t){return this._target.order=t,this.onChange(),this}fromRotationMatrix(t,e=this.order){return function(t,e,i="YXZ"){"XYZ"===i?(t[1]=Math.asin(Math.min(Math.max(e[8],-1),1)),Math.abs(e[8])<.99999?(t[0]=Math.atan2(-e[9],e[10]),t[2]=Math.atan2(-e[4],e[0])):(t[0]=Math.atan2(e[6],e[5]),t[2]=0)):"YXZ"===i?(t[0]=Math.asin(-Math.min(Math.max(e[9],-1),1)),Math.abs(e[9])<.99999?(t[1]=Math.atan2(e[8],e[10]),t[2]=Math.atan2(e[1],e[5])):(t[1]=Math.atan2(-e[2],e[0]),t[2]=0)):"ZXY"===i?(t[0]=Math.asin(Math.min(Math.max(e[6],-1),1)),Math.abs(e[6])<.99999?(t[1]=Math.atan2(-e[2],e[10]),t[2]=Math.atan2(-e[4],e[5])):(t[1]=0,t[2]=Math.atan2(e[1],e[0]))):"ZYX"===i?(t[1]=Math.asin(-Math.min(Math.max(e[2],-1),1)),Math.abs(e[2])<.99999?(t[0]=Math.atan2(e[6],e[10]),t[2]=Math.atan2(e[1],e[0])):(t[0]=0,t[2]=Math.atan2(-e[4],e[5]))):"YZX"===i?(t[2]=Math.asin(Math.min(Math.max(e[1],-1),1)),Math.abs(e[1])<.99999?(t[0]=Math.atan2(-e[9],e[5]),t[1]=Math.atan2(-e[2],e[0])):(t[0]=0,t[1]=Math.atan2(e[8],e[10]))):"XZY"===i&&(t[2]=Math.asin(-Math.min(Math.max(e[4],-1),1)),Math.abs(e[4])<.99999?(t[0]=Math.atan2(e[6],e[5]),t[1]=Math.atan2(e[8],e[0])):(t[0]=Math.atan2(-e[9],e[10]),t[1]=0))}(this._target,t,e),this.onChange(),this}fromQuaternion(t,e=this.order,i){return j.fromQuaternion(t),this._target.fromRotationMatrix(j,e),i||this.onChange(),this}fromArray(t,e=0){return this._target[0]=t[e],this._target[1]=t[e+1],this._target[2]=t[e+2],this}toArray(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t}}class U{constructor(){this.parent=null,this.children=[],this.visible=!0,this.matrix=new B,this.worldMatrix=new B,this.matrixAutoUpdate=!0,this.worldMatrixNeedsUpdate=!1,this.position=new p,this.quaternion=new T,this.scale=new p(1),this.rotation=new I,this.up=new p(0,1,0),this.rotation._target.onChange=()=>this.quaternion.fromEuler(this.rotation,!0),this.quaternion._target.onChange=()=>this.rotation.fromQuaternion(this.quaternion,void 0,!0)}setParent(t,e=!0){this.parent&&t!==this.parent&&this.parent.removeChild(this,!1),this.parent=t,e&&t&&t.addChild(this,!1)}addChild(t,e=!0){~this.children.indexOf(t)||this.children.push(t),e&&t.setParent(this,!1)}removeChild(t,e=!0){~this.children.indexOf(t)&&this.children.splice(this.children.indexOf(t),1),e&&t.setParent(null,!1)}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.worldMatrixNeedsUpdate||t)&&(null===this.parent?this.worldMatrix.copy(this.matrix):this.worldMatrix.multiply(this.parent.worldMatrix,this.matrix),this.worldMatrixNeedsUpdate=!1,t=!0);for(let e=0,i=this.children.length;e<i;e++)this.children[e].updateMatrixWorld(t)}updateMatrix(){this.matrix.compose(this.quaternion,this.position,this.scale),this.worldMatrixNeedsUpdate=!0}traverse(t){if(!t(this))for(let e=0,i=this.children.length;e<i;e++)this.children[e].traverse(t)}decompose(){this.matrix.decompose(this.quaternion._target,this.position,this.scale),this.rotation.fromQuaternion(this.quaternion)}lookAt(t,e=!1){e?this.matrix.lookAt(this.position,t,this.up):this.matrix.lookAt(t,this.position,this.up),this.matrix.getRotation(this.quaternion._target),this.rotation.fromQuaternion(this.quaternion)}}const z=new B,K=new p,q=new p;class G extends U{constructor(t,{near:e=.1,far:i=100,fov:s=45,aspect:n=1,left:r,right:o,bottom:a,top:l,zoom:h=1}={}){super(),Object.assign(this,{near:e,far:i,fov:s,aspect:n,left:r,right:o,bottom:a,top:l,zoom:h}),this.projectionMatrix=new B,this.viewMatrix=new B,this.projectionViewMatrix=new B,this.worldPosition=new p,this.type=r||o?"orthographic":"perspective","orthographic"===this.type?this.orthographic():this.perspective()}perspective({near:t=this.near,far:e=this.far,fov:i=this.fov,aspect:s=this.aspect}={}){return Object.assign(this,{near:t,far:e,fov:i,aspect:s}),this.projectionMatrix.fromPerspective({fov:i*(Math.PI/180),aspect:s,near:t,far:e}),this.type="perspective",this}orthographic({near:t=this.near,far:e=this.far,left:i=this.left||-1,right:s=this.right||1,bottom:n=this.bottom||-1,top:r=this.top||1,zoom:o=this.zoom}={}){return Object.assign(this,{near:t,far:e,left:i,right:s,bottom:n,top:r,zoom:o}),i/=o,s/=o,n/=o,r/=o,this.projectionMatrix.fromOrthogonal({left:i,right:s,bottom:n,top:r,near:t,far:e}),this.type="orthographic",this}updateMatrixWorld(){return super.updateMatrixWorld(),this.viewMatrix.inverse(this.worldMatrix),this.worldMatrix.getTranslation(this.worldPosition),this.projectionViewMatrix.multiply(this.projectionMatrix,this.viewMatrix),this}updateProjectionMatrix(){return"perspective"===this.type?this.perspective():this.orthographic()}lookAt(t){return super.lookAt(t,!0),this}project(t){return t.applyMatrix4(this.viewMatrix),t.applyMatrix4(this.projectionMatrix),this}unproject(t){return t.applyMatrix4(z.inverse(this.projectionMatrix)),t.applyMatrix4(this.worldMatrix),this}updateFrustum(){this.frustum||(this.frustum=[new p,new p,new p,new p,new p,new p]);const t=this.projectionViewMatrix;this.frustum[0].set(t[3]-t[0],t[7]-t[4],t[11]-t[8]).constant=t[15]-t[12],this.frustum[1].set(t[3]+t[0],t[7]+t[4],t[11]+t[8]).constant=t[15]+t[12],this.frustum[2].set(t[3]+t[1],t[7]+t[5],t[11]+t[9]).constant=t[15]+t[13],this.frustum[3].set(t[3]-t[1],t[7]-t[5],t[11]-t[9]).constant=t[15]-t[13],this.frustum[4].set(t[3]-t[2],t[7]-t[6],t[11]-t[10]).constant=t[15]-t[14],this.frustum[5].set(t[3]+t[2],t[7]+t[6],t[11]+t[10]).constant=t[15]+t[14];for(let t=0;t<6;t++){const e=1/this.frustum[t].distance();this.frustum[t].multiply(e),this.frustum[t].constant*=e}}frustumIntersectsMesh(t,e=t.worldMatrix){if(!t.geometry.attributes.position)return!0;if(t.geometry.bounds&&t.geometry.bounds.radius!==1/0||t.geometry.computeBoundingSphere(),!t.geometry.bounds)return!0;const i=K;i.copy(t.geometry.bounds.center),i.applyMatrix4(e);const s=t.geometry.bounds.radius*e.getMaxScaleOnAxis();return this.frustumIntersectsSphere(i,s)}frustumIntersectsSphere(t,e){const i=q;for(let s=0;s<6;s++){const n=this.frustum[s];if(i.copy(n).dot(t)+n.constant<-e)return!1}return!0}}function H(t,e,i){let s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],h=e[6],p=e[7],c=e[8],u=i[0],d=i[1],v=i[2],m=i[3],g=i[4],b=i[5],f=i[6],_=i[7],w=i[8];return t[0]=u*s+d*o+v*h,t[1]=u*n+d*a+v*p,t[2]=u*r+d*l+v*c,t[3]=m*s+g*o+b*h,t[4]=m*n+g*a+b*p,t[5]=m*r+g*l+b*c,t[6]=f*s+_*o+w*h,t[7]=f*n+_*a+w*p,t[8]=f*r+_*l+w*c,t}class $ extends Array{constructor(t=1,e=0,i=0,s=0,n=1,r=0,o=0,a=0,l=1){return super(t,e,i,s,n,r,o,a,l),this}set(t,e,i,s,n,r,o,a,l){return t.length?this.copy(t):(function(t,e,i,s,n,r,o,a,l,h){t[0]=e,t[1]=i,t[2]=s,t[3]=n,t[4]=r,t[5]=o,t[6]=a,t[7]=l,t[8]=h}(this,t,e,i,s,n,r,o,a,l),this)}translate(t,e=this){return function(t,e,i){let s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],h=e[6],p=e[7],c=e[8],u=i[0],d=i[1];t[0]=s,t[1]=n,t[2]=r,t[3]=o,t[4]=a,t[5]=l,t[6]=u*s+d*o+h,t[7]=u*n+d*a+p,t[8]=u*r+d*l+c}(this,e,t),this}rotate(t,e=this){return function(t,e,i){let s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],h=e[6],p=e[7],c=e[8],u=Math.sin(i),d=Math.cos(i);t[0]=d*s+u*o,t[1]=d*n+u*a,t[2]=d*r+u*l,t[3]=d*o-u*s,t[4]=d*a-u*n,t[5]=d*l-u*r,t[6]=h,t[7]=p,t[8]=c}(this,e,t),this}scale(t,e=this){return function(t,e,i){let s=i[0],n=i[1];t[0]=s*e[0],t[1]=s*e[1],t[2]=s*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8]}(this,e,t),this}multiply(t,e){return e?H(this,t,e):H(this,this,t),this}identity(){var t;return(t=this)[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this}copy(t){var e,i;return i=t,(e=this)[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this}fromMatrix4(t){var e,i;return i=t,(e=this)[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[4],e[4]=i[5],e[5]=i[6],e[6]=i[8],e[7]=i[9],e[8]=i[10],this}fromQuaternion(t){return function(t,e){let i=e[0],s=e[1],n=e[2],r=e[3],o=i+i,a=s+s,l=n+n,h=i*o,p=s*o,c=s*a,u=n*o,d=n*a,v=n*l,m=r*o,g=r*a,b=r*l;t[0]=1-c-v,t[3]=p-b,t[6]=u+g,t[1]=p+b,t[4]=1-h-v,t[7]=d-m,t[2]=u-g,t[5]=d+m,t[8]=1-h-c}(this,t),this}fromBasis(t,e,i){return this.set(t[0],t[1],t[2],e[0],e[1],e[2],i[0],i[1],i[2]),this}inverse(t=this){return function(t,e){let i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],h=e[7],p=e[8],c=p*o-a*h,u=-p*r+a*l,d=h*r-o*l,v=i*c+s*u+n*d;v&&(v=1/v,t[0]=c*v,t[1]=(-p*s+n*h)*v,t[2]=(a*s-n*o)*v,t[3]=u*v,t[4]=(p*i-n*l)*v,t[5]=(-a*i+n*r)*v,t[6]=d*v,t[7]=(-h*i+s*l)*v,t[8]=(o*i-s*r)*v)}(this,t),this}getNormalMatrix(t){return function(t,e){let i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],h=e[7],p=e[8],c=e[9],u=e[10],d=e[11],v=e[12],m=e[13],g=e[14],b=e[15],f=i*a-s*o,_=i*l-n*o,w=i*h-r*o,x=s*l-n*a,y=s*h-r*a,C=n*h-r*l,E=p*m-c*v,P=p*g-u*v,k=p*b-d*v,M=c*g-u*m,V=c*b-d*m,A=u*b-d*g,S=f*A-_*V+w*M+x*k-y*P+C*E;S&&(S=1/S,t[0]=(a*A-l*V+h*M)*S,t[1]=(l*k-o*A-h*P)*S,t[2]=(o*V-a*k+h*E)*S,t[3]=(n*V-s*A-r*M)*S,t[4]=(i*A-n*k+r*P)*S,t[5]=(s*k-i*V-r*E)*S,t[6]=(m*C-g*y+b*x)*S,t[7]=(g*w-v*C-b*_)*S,t[8]=(v*y-m*w+b*f)*S)}(this,t),this}}let X=0;class Y extends U{constructor(t,{geometry:e,program:i,mode:s=t.TRIANGLES,frustumCulled:n=!0,renderOrder:r=0}={}){super(),t.canvas||console.error("gl not passed as first argument to Mesh"),this.gl=t,this.id=X++,this.geometry=e,this.program=i,this.mode=s,this.frustumCulled=n,this.renderOrder=r,this.modelViewMatrix=new B,this.normalMatrix=new $,this.beforeRenderCallbacks=[],this.afterRenderCallbacks=[]}onBeforeRender(t){return this.beforeRenderCallbacks.push(t),this}onAfterRender(t){return this.afterRenderCallbacks.push(t),this}draw({camera:t}={}){t&&(this.program.uniforms.modelMatrix||Object.assign(this.program.uniforms,{modelMatrix:{value:null},viewMatrix:{value:null},modelViewMatrix:{value:null},normalMatrix:{value:null},projectionMatrix:{value:null},cameraPosition:{value:null}}),this.program.uniforms.projectionMatrix.value=t.projectionMatrix,this.program.uniforms.cameraPosition.value=t.worldPosition,this.program.uniforms.viewMatrix.value=t.viewMatrix,this.modelViewMatrix.multiply(t.viewMatrix,this.worldMatrix),this.normalMatrix.getNormalMatrix(this.modelViewMatrix),this.program.uniforms.modelMatrix.value=this.worldMatrix,this.program.uniforms.modelViewMatrix.value=this.modelViewMatrix,this.program.uniforms.normalMatrix.value=this.normalMatrix),this.beforeRenderCallbacks.forEach(e=>e&&e({mesh:this,camera:t}));let e=this.program.cullFace&&this.worldMatrix.determinant()<0;this.program.use({flipFaces:e}),this.geometry.draw({mode:this.mode,program:this.program}),this.afterRenderCallbacks.forEach(e=>e&&e({mesh:this,camera:t}))}}const W=new Uint8Array(4);function Z(t){return!(t&t-1)}let Q=1;class J{constructor(t,{image:e,target:i=t.TEXTURE_2D,type:s=t.UNSIGNED_BYTE,format:n=t.RGBA,internalFormat:r=n,wrapS:o=t.CLAMP_TO_EDGE,wrapT:a=t.CLAMP_TO_EDGE,wrapR:l=t.CLAMP_TO_EDGE,generateMipmaps:h=i===(t.TEXTURE_2D||t.TEXTURE_CUBE_MAP),minFilter:p=(h?t.NEAREST_MIPMAP_LINEAR:t.LINEAR),magFilter:c=t.LINEAR,premultiplyAlpha:u=!1,unpackAlignment:d=4,flipY:v=i==(t.TEXTURE_2D||t.TEXTURE_3D),anisotropy:m=0,level:g=0,width:b,height:f=b,length:_=1}={}){this.gl=t,this.id=Q++,this.image=e,this.target=i,this.type=s,this.format=n,this.internalFormat=r,this.minFilter=p,this.magFilter=c,this.wrapS=o,this.wrapT=a,this.wrapR=l,this.generateMipmaps=h,this.premultiplyAlpha=u,this.unpackAlignment=d,this.flipY=v,this.anisotropy=Math.min(m,this.gl.renderer.parameters.maxAnisotropy),this.level=g,this.width=b,this.height=f,this.length=_,this.texture=this.gl.createTexture(),this.store={image:null},this.glState=this.gl.renderer.state,this.state={},this.state.minFilter=this.gl.NEAREST_MIPMAP_LINEAR,this.state.magFilter=this.gl.LINEAR,this.state.wrapS=this.gl.REPEAT,this.state.wrapT=this.gl.REPEAT,this.state.anisotropy=0}bind(){this.glState.textureUnits[this.glState.activeTextureUnit]!==this.id&&(this.gl.bindTexture(this.target,this.texture),this.glState.textureUnits[this.glState.activeTextureUnit]=this.id)}update(t=0){const e=!(this.image===this.store.image&&!this.needsUpdate);if((e||this.glState.textureUnits[t]!==this.id)&&(this.gl.renderer.activeTexture(t),this.bind()),e){if(this.needsUpdate=!1,this.flipY!==this.glState.flipY&&(this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,this.flipY),this.glState.flipY=this.flipY),this.premultiplyAlpha!==this.glState.premultiplyAlpha&&(this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),this.glState.premultiplyAlpha=this.premultiplyAlpha),this.unpackAlignment!==this.glState.unpackAlignment&&(this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,this.unpackAlignment),this.glState.unpackAlignment=this.unpackAlignment),this.minFilter!==this.state.minFilter&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_MIN_FILTER,this.minFilter),this.state.minFilter=this.minFilter),this.magFilter!==this.state.magFilter&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_MAG_FILTER,this.magFilter),this.state.magFilter=this.magFilter),this.wrapS!==this.state.wrapS&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_S,this.wrapS),this.state.wrapS=this.wrapS),this.wrapT!==this.state.wrapT&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_T,this.wrapT),this.state.wrapT=this.wrapT),this.wrapR!==this.state.wrapR&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_R,this.wrapR),this.state.wrapR=this.wrapR),this.anisotropy&&this.anisotropy!==this.state.anisotropy&&(this.gl.texParameterf(this.target,this.gl.renderer.getExtension("EXT_texture_filter_anisotropic").TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropy),this.state.anisotropy=this.anisotropy),this.image){if(this.image.width&&(this.width=this.image.width,this.height=this.image.height),this.target===this.gl.TEXTURE_CUBE_MAP)for(let t=0;t<6;t++)this.gl.texImage2D(this.gl.TEXTURE_CUBE_MAP_POSITIVE_X+t,this.level,this.internalFormat,this.format,this.type,this.image[t]);else if(ArrayBuffer.isView(this.image))this.target===this.gl.TEXTURE_2D?this.gl.texImage2D(this.target,this.level,this.internalFormat,this.width,this.height,0,this.format,this.type,this.image):this.target!==this.gl.TEXTURE_2D_ARRAY&&this.target!==this.gl.TEXTURE_3D||this.gl.texImage3D(this.target,this.level,this.internalFormat,this.width,this.height,this.length,0,this.format,this.type,this.image);else if(this.image.isCompressedTexture)for(let t=0;t<this.image.length;t++)this.gl.compressedTexImage2D(this.target,t,this.internalFormat,this.image[t].width,this.image[t].height,0,this.image[t].data);else this.target===this.gl.TEXTURE_2D?this.gl.texImage2D(this.target,this.level,this.internalFormat,this.format,this.type,this.image):this.gl.texImage3D(this.target,this.level,this.internalFormat,this.width,this.height,this.length,0,this.format,this.type,this.image);this.generateMipmaps&&(this.gl.renderer.isWebgl2||Z(this.image.width)&&Z(this.image.height)?this.gl.generateMipmap(this.target):(this.generateMipmaps=!1,this.wrapS=this.wrapT=this.gl.CLAMP_TO_EDGE,this.minFilter=this.gl.LINEAR)),this.onUpdate&&this.onUpdate()}else if(this.target===this.gl.TEXTURE_CUBE_MAP)for(let t=0;t<6;t++)this.gl.texImage2D(this.gl.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,W);else this.width?this.target===this.gl.TEXTURE_2D?this.gl.texImage2D(this.target,this.level,this.internalFormat,this.width,this.height,0,this.format,this.type,null):this.gl.texImage3D(this.target,this.level,this.internalFormat,this.width,this.height,this.length,0,this.format,this.type,null):this.gl.texImage2D(this.target,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,W);this.store.image=this.image}}}class tt{constructor(t,{width:e=t.canvas.width,height:i=t.canvas.height,target:s=t.FRAMEBUFFER,color:n=1,depth:r=!0,stencil:o=!1,depthTexture:a=!1,wrapS:l=t.CLAMP_TO_EDGE,wrapT:h=t.CLAMP_TO_EDGE,wrapR:p=t.CLAMP_TO_EDGE,minFilter:c=t.LINEAR,magFilter:u=c,type:d=t.UNSIGNED_BYTE,format:v=t.RGBA,internalFormat:m=v,unpackAlignment:g,premultiplyAlpha:b}={}){this.gl=t,this.width=e,this.height=i,this.depth=r,this.stencil=o,this.buffer=this.gl.createFramebuffer(),this.target=s,this.gl.renderer.bindFramebuffer(this),this.textures=[];const f=[];for(let s=0;s<n;s++)this.textures.push(new J(t,{width:e,height:i,wrapS:l,wrapT:h,wrapR:p,minFilter:c,magFilter:u,type:d,format:v,internalFormat:m,unpackAlignment:g,premultiplyAlpha:b,flipY:!1,generateMipmaps:!1})),this.textures[s].update(),this.gl.framebufferTexture2D(this.target,this.gl.COLOR_ATTACHMENT0+s,this.gl.TEXTURE_2D,this.textures[s].texture,0),f.push(this.gl.COLOR_ATTACHMENT0+s);f.length>1&&this.gl.renderer.drawBuffers(f),this.texture=this.textures[0],a&&(this.gl.renderer.isWebgl2||this.gl.renderer.getExtension("WEBGL_depth_texture"))?(this.depthTexture=new J(t,{width:e,height:i,minFilter:this.gl.NEAREST,magFilter:this.gl.NEAREST,format:this.stencil?this.gl.DEPTH_STENCIL:this.gl.DEPTH_COMPONENT,internalFormat:t.renderer.isWebgl2?this.stencil?this.gl.DEPTH24_STENCIL8:this.gl.DEPTH_COMPONENT16:this.gl.DEPTH_COMPONENT,type:this.stencil?this.gl.UNSIGNED_INT_24_8:this.gl.UNSIGNED_INT}),this.depthTexture.update(),this.gl.framebufferTexture2D(this.target,this.stencil?this.gl.DEPTH_STENCIL_ATTACHMENT:this.gl.DEPTH_ATTACHMENT,this.gl.TEXTURE_2D,this.depthTexture.texture,0)):(r&&!o&&(this.depthBuffer=this.gl.createRenderbuffer(),this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,this.depthBuffer),this.gl.renderbufferStorage(this.gl.RENDERBUFFER,this.gl.DEPTH_COMPONENT16,e,i),this.gl.framebufferRenderbuffer(this.target,this.gl.DEPTH_ATTACHMENT,this.gl.RENDERBUFFER,this.depthBuffer)),o&&!r&&(this.stencilBuffer=this.gl.createRenderbuffer(),this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,this.stencilBuffer),this.gl.renderbufferStorage(this.gl.RENDERBUFFER,this.gl.STENCIL_INDEX8,e,i),this.gl.framebufferRenderbuffer(this.target,this.gl.STENCIL_ATTACHMENT,this.gl.RENDERBUFFER,this.stencilBuffer)),r&&o&&(this.depthStencilBuffer=this.gl.createRenderbuffer(),this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,this.depthStencilBuffer),this.gl.renderbufferStorage(this.gl.RENDERBUFFER,this.gl.DEPTH_STENCIL,e,i),this.gl.framebufferRenderbuffer(this.target,this.gl.DEPTH_STENCIL_ATTACHMENT,this.gl.RENDERBUFFER,this.depthStencilBuffer))),this.gl.renderer.bindFramebuffer({target:this.target})}setSize(t,e){if(this.width!==t||this.height!==e){this.width=t,this.height=e,this.gl.renderer.bindFramebuffer(this);for(let i=0;i<this.textures.length;i++)this.textures[i].width=t,this.textures[i].height=e,this.textures[i].needsUpdate=!0,this.textures[i].update(),this.gl.framebufferTexture2D(this.target,this.gl.COLOR_ATTACHMENT0+i,this.gl.TEXTURE_2D,this.textures[i].texture,0);this.depthTexture?(this.depthTexture.width=t,this.depthTexture.height=e,this.depthTexture.needsUpdate=!0,this.depthTexture.update(),this.gl.framebufferTexture2D(this.target,this.gl.DEPTH_ATTACHMENT,this.gl.TEXTURE_2D,this.depthTexture.texture,0)):(this.depthBuffer&&(this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,this.depthBuffer),this.gl.renderbufferStorage(this.gl.RENDERBUFFER,this.gl.DEPTH_COMPONENT16,t,e)),this.stencilBuffer&&(this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,this.stencilBuffer),this.gl.renderbufferStorage(this.gl.RENDERBUFFER,this.gl.STENCIL_INDEX8,t,e)),this.depthStencilBuffer&&(this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,this.depthStencilBuffer),this.gl.renderbufferStorage(this.gl.RENDERBUFFER,this.gl.DEPTH_STENCIL,t,e))),this.gl.renderer.bindFramebuffer({target:this.target})}}}class et extends m{constructor(t,{width:e=1,height:i=1,widthSegments:s=1,heightSegments:n=1,attributes:r={}}={}){const o=s,a=n,l=(o+1)*(a+1),h=o*a*6,p=new Float32Array(3*l),c=new Float32Array(3*l),u=new Float32Array(2*l),d=h>65536?new Uint32Array(h):new Uint16Array(h);et.buildPlane(p,c,u,d,e,i,0,o,a),Object.assign(r,{position:{size:3,data:p},normal:{size:3,data:c},uv:{size:2,data:u},index:{data:d}}),super(t,r)}static buildPlane(t,e,i,s,n,r,o,a,l,h=0,p=1,c=2,u=1,d=-1,v=0,m=0){const g=v,b=n/a,f=r/l;for(let _=0;_<=l;_++){let w=_*f-r/2;for(let r=0;r<=a;r++,v++){let f=r*b-n/2;if(t[3*v+h]=f*u,t[3*v+p]=w*d,t[3*v+c]=o/2,e[3*v+h]=0,e[3*v+p]=0,e[3*v+c]=o>=0?1:-1,i[2*v]=r/a,i[2*v+1]=1-_/l,_===l||r===a)continue;let x=g+r+_*(a+1),y=g+r+(_+1)*(a+1),C=g+r+(_+1)*(a+1)+1,E=g+r+_*(a+1)+1;s[6*m]=x,s[6*m+1]=y,s[6*m+2]=E,s[6*m+3]=y,s[6*m+4]=C,s[6*m+5]=E,m++}}}}var it,st={};var nt=(it||(it=1,st.resolveLygia=function(t){Array.isArray(t)||(t=t.split(/\r?\n/));let e="";return t.forEach((t,i)=>{let s=t.trim();if(s.startsWith('#include "lygia')){let t=s.substring(15);t="https://lygia.xyz"+t.replace(/\"|\;|\s/g,""),e+=function(t){let e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(),200==e.status?e.responseText:""}(t)+"\n"}else e+=t+"\n"}),e}),st);function rt(t){return null==t}function ot(t){return null!==t&&"object"==typeof t}function at(t){return null!==t&&"object"==typeof t}function lt(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function ht(t,e){return Array.from(new Set([...Object.keys(t),...Object.keys(e)])).reduce((i,s)=>{const n=t[s],r=e[s];return at(n)&&at(r)?Object.assign(Object.assign({},i),{[s]:ht(n,r)}):Object.assign(Object.assign({},i),{[s]:s in e?r:n})},{})}function pt(t){return!!ot(t)&&"target"in t}const ct={alreadydisposed:()=>"View has been already disposed",invalidparams:t=>`Invalid parameters for '${t.name}'`,nomatchingcontroller:t=>`No matching controller for '${t.key}'`,nomatchingview:t=>`No matching view for '${JSON.stringify(t.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:t=>`Not compatible with  plugin '${t.id}'`,propertynotfound:t=>`Property '${t.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class ut{static alreadyDisposed(){return new ut({type:"alreadydisposed"})}static notBindable(){return new ut({type:"notbindable"})}static notCompatible(t,e){return new ut({type:"notcompatible",context:{id:`${t}.${e}`}})}static propertyNotFound(t){return new ut({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new ut({type:"shouldneverhappen"})}constructor(t){var e;this.message=null!==(e=ct[t.type](t.context))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}toString(){return this.message}}class dt{constructor(t,e){this.obj_=t,this.key=e}static isBindable(t){return null!==t&&("object"==typeof t||"function"==typeof t)}read(){return this.obj_[this.key]}write(t){this.obj_[this.key]=t}writeProperty(t,e){const i=this.read();if(!dt.isBindable(i))throw ut.notBindable();if(!(t in i))throw ut.propertyNotFound(t);i[t]=e}}class vt{constructor(){this.observers_={}}on(t,e,i){var s;let n=this.observers_[t];return n||(n=this.observers_[t]=[]),n.push({handler:e,key:null!==(s=null==i?void 0:i.key)&&void 0!==s?s:e}),this}off(t,e){const i=this.observers_[t];return i&&(this.observers_[t]=i.filter(t=>t.key!==e)),this}emit(t,e){const i=this.observers_[t];i&&i.forEach(t=>{t.handler(e)})}}class mt{constructor(t,e){var i;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(i=null==e?void 0:e.equals)&&void 0!==i?i:(t,e)=>t===e,this.emitter=new vt,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=null!=e?e:{forceEmit:!1,last:!0},s=this.constraint_?this.constraint_.constrain(t):t,n=this.rawValue_;(!this.equals_(n,s)||i.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=s,this.emitter.emit("change",{options:i,previousRawValue:n,rawValue:s,sender:this}))}}class gt{constructor(t){this.emitter=new vt,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=null!=e?e:{forceEmit:!1,last:!0},s=this.value_;(s!==t||i.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:i,previousRawValue:s,rawValue:this.value_,sender:this}))}}class bt{constructor(t){this.emitter=new vt,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=t,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(t){this.emitter.emit("beforechange",Object.assign(Object.assign({},t),{sender:this}))}onValueChange_(t){this.emitter.emit("change",Object.assign(Object.assign({},t),{sender:this}))}}function ft(t,e){const i=null==e?void 0:e.constraint,s=null==e?void 0:e.equals;return i||s?new mt(t,e):new gt(t)}class _t{constructor(t){this.emitter=new vt,this.valMap_=t;for(const t in this.valMap_){this.valMap_[t].emitter.on("change",()=>{this.emitter.emit("change",{key:t,sender:this})})}}static createCore(t){return Object.keys(t).reduce((e,i)=>Object.assign(e,{[i]:ft(t[i])}),{})}static fromObject(t){const e=this.createCore(t);return new _t(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}class wt{constructor(t){this.values=_t.fromObject({max:t.max,min:t.min})}constrain(t){const e=this.values.get("max"),i=this.values.get("min");return Math.min(Math.max(t,i),e)}}class xt{constructor(t){this.values=_t.fromObject({max:t.max,min:t.min})}constrain(t){const e=this.values.get("max"),i=this.values.get("min");let s=t;return rt(i)||(s=Math.max(s,i)),rt(e)||(s=Math.min(s,e)),s}}class yt{constructor(t,e=0){this.step=t,this.origin=e}constrain(t){const e=this.origin%this.step;return e+Math.round((t-e)/this.step)*this.step}}class Ct{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const Et={"**":(t,e)=>Math.pow(t,e),"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e,"&":(t,e)=>t&e,"^":(t,e)=>t^e,"|":(t,e)=>t|e};class Pt{constructor(t,e,i){this.left=e,this.operator=t,this.right=i}evaluate(){const t=Et[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const kt={"+":t=>t,"-":t=>-t,"~":t=>~t};class Mt{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=kt[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function Vt(t){return(e,i)=>{for(let s=0;s<t.length;s++){const n=t[s](e,i);if(""!==n)return n}return""}}function At(t,e){var i;const s=t.substr(e).match(/^\s+/);return null!==(i=s&&s[0])&&void 0!==i?i:""}function St(t,e){var i;const s=t.substr(e).match(/^[0-9]+/);return null!==(i=s&&s[0])&&void 0!==i?i:""}function Tt(t,e){const i=t.substr(e,1);if(e+=1,"e"!==i.toLowerCase())return"";const s=function(t,e){const i=St(t,e);if(""!==i)return i;const s=t.substr(e,1);if("-"!==s&&"+"!==s)return"";const n=St(t,e+=1);return""===n?"":s+n}(t,e);return""===s?"":i+s}function Lt(t,e){const i=t.substr(e,1);if("0"===i)return i;const s=function(t,e){const i=t.substr(e,1);return i.match(/^[1-9]$/)?i:""}(t,e);return e+=s.length,""===s?"":s+St(t,e)}const Rt=Vt([function(t,e){const i=Lt(t,e);if(e+=i.length,""===i)return"";const s=t.substr(e,1);if(e+=s.length,"."!==s)return"";const n=St(t,e);return i+s+n+Tt(t,e+=n.length)},function(t,e){const i=t.substr(e,1);if(e+=i.length,"."!==i)return"";const s=St(t,e);return e+=s.length,""===s?"":i+s+Tt(t,e)},function(t,e){const i=Lt(t,e);return e+=i.length,""===i?"":i+Tt(t,e)}]);const Dt=Vt([function(t,e){const i=t.substr(e,2);if(e+=i.length,"0b"!==i.toLowerCase())return"";const s=function(t,e){var i;const s=t.substr(e).match(/^[01]+/);return null!==(i=s&&s[0])&&void 0!==i?i:""}(t,e);return""===s?"":i+s},function(t,e){const i=t.substr(e,2);if(e+=i.length,"0o"!==i.toLowerCase())return"";const s=function(t,e){var i;const s=t.substr(e).match(/^[0-7]+/);return null!==(i=s&&s[0])&&void 0!==i?i:""}(t,e);return""===s?"":i+s},function(t,e){const i=t.substr(e,2);if(e+=i.length,"0x"!==i.toLowerCase())return"";const s=function(t,e){var i;const s=t.substr(e).match(/^[0-9a-f]+/i);return null!==(i=s&&s[0])&&void 0!==i?i:""}(t,e);return""===s?"":i+s}]),Ft=Vt([Dt,Rt]);function Ot(t,e){var i;return null!==(i=function(t,e){const i=Ft(t,e);return e+=i.length,""===i?null:{evaluable:new Ct(i),cursor:e}}(t,e))&&void 0!==i?i:function(t,e){const i=t.substr(e,1);if(e+=i.length,"("!==i)return null;const s=jt(t,e);if(!s)return null;e=s.cursor,e+=At(t,e).length;const n=t.substr(e,1);return e+=n.length,")"!==n?null:{evaluable:s.evaluable,cursor:e}}(t,e)}function Nt(t,e,i){i+=At(e,i).length;const s=t.filter(t=>e.startsWith(t,i))[0];return s?(i+=s.length,{cursor:i+=At(e,i).length,operator:s}):null}const Bt=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((t,e)=>function(t,e){return(i,s)=>{const n=t(i,s);if(!n)return null;s=n.cursor;let r=n.evaluable;for(;;){const n=Nt(e,i,s);if(!n)break;s=n.cursor;const o=t(i,s);if(!o)return null;s=o.cursor,r=new Pt(n.operator,r,o.evaluable)}return r?{cursor:s,evaluable:r}:null}}(t,e),function t(e,i){const s=Ot(e,i);if(s)return s;const n=e.substr(i,1);if(i+=n.length,"+"!==n&&"-"!==n&&"~"!==n)return null;const r=t(e,i);return r?{cursor:i=r.cursor,evaluable:new Mt(n,r.evaluable)}:null});function jt(t,e){return e+=At(t,e).length,Bt(t,e)}function It(t){var e;const i=function(t){const e=jt(t,0);return e?e.cursor+At(t,e.cursor).length!==t.length?null:e.evaluable:null}(t);return null!==(e=null==i?void 0:i.evaluate())&&void 0!==e?e:null}function Ut(t){if("number"==typeof t)return t;if("string"==typeof t){const e=It(t);if(!rt(e))return e}return 0}function zt(t){return String(t)}function Kt(t){return e=>e.toFixed(Math.max(Math.min(t,20),0))}function qt(t,e,i,s,n){return s+(t-e)/(i-e)*(n-s)}function Gt(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Ht(t,e,i){return Math.min(Math.max(t,e),i)}function $t(t,e){return(t%e+e)%e}function Xt(t,e){return rt(t.step)?Math.max(Gt(e),2):Gt(t.step)}function Yt(t){var e;return null!==(e=t.step)&&void 0!==e?e:1}function Wt(t,e){var i;const s=Math.abs(null!==(i=t.step)&&void 0!==i?i:e);return 0===s?.1:Math.pow(10,Math.floor(Math.log10(s))-1)}function Zt(t,e){return rt(t.step)?null:new yt(t.step,e)}function Qt(t){return rt(t.max)||rt(t.min)?rt(t.max)&&rt(t.min)?null:new xt({max:t.max,min:t.min}):new wt({max:t.max,min:t.min})}function Jt(t,e){var i,s,n;return{formatter:null!==(i=t.format)&&void 0!==i?i:Kt(Xt(t,e)),keyScale:null!==(s=t.keyScale)&&void 0!==s?s:Yt(t),pointerScale:null!==(n=t.pointerScale)&&void 0!==n?n:Wt(t,e)}}function te(t){return{format:t.optional.function,keyScale:t.optional.number,max:t.optional.number,min:t.optional.number,pointerScale:t.optional.number,step:t.optional.number}}function ee(t){return{constraint:t.constraint,textProps:_t.fromObject(Jt(t.params,t.initialValue))}}class ie{constructor(t){this.controller=t}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(t){this.controller.viewProps.set("disabled",t)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(t){this.controller.viewProps.set("hidden",t)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(t){return this.controller.importState(t)}exportState(){return this.controller.exportState()}}class se{constructor(t){this.target=t}}class ne extends se{constructor(t,e,i){super(t),this.value=e,this.last=null==i||i}}class re extends se{constructor(t,e){super(t),this.expanded=e}}class oe extends se{constructor(t,e){super(t),this.index=e}}class ae extends se{constructor(t,e){super(t),this.native=e}}class le extends ie{constructor(t){super(t),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new vt,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(t){this.controller.labelController.props.set("label",t)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(t){this.controller.tag=t}on(t,e){const i=e.bind(this);return this.emitter_.on(t,t=>{i(t)},{key:e}),this}off(t,e){return this.emitter_.off(t,e),this}refresh(){this.controller.value.fetch()}onValueChange_(t){const e=this.controller.value;this.emitter_.emit("change",new ne(this,e.binding.target.read(),t.options.last))}}class he{constructor(t,e){this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.binding=e,this.value_=t,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_),this.emitter=new vt}get rawValue(){return this.value_.rawValue}set rawValue(t){this.value_.rawValue=t}setRawValue(t,e){this.value_.setRawValue(t,e)}fetch(){this.value_.rawValue=this.binding.read()}push(){this.binding.write(this.value_.rawValue)}onValueBeforeChange_(t){this.emitter.emit("beforechange",Object.assign(Object.assign({},t),{sender:this}))}onValueChange_(t){this.push(),this.emitter.emit("change",Object.assign(Object.assign({},t),{sender:this}))}}function pe(t){return e=>i=>{if(!e&&void 0===i)return{succeeded:!1,value:void 0};if(e&&void 0===i)return{succeeded:!0,value:void 0};const s=t(i);return void 0!==s?{succeeded:!0,value:s}:{succeeded:!1,value:void 0}}}function ce(t){return{custom:e=>pe(e)(t),boolean:pe(t=>"boolean"==typeof t?t:void 0)(t),number:pe(t=>"number"==typeof t?t:void 0)(t),string:pe(t=>"string"==typeof t?t:void 0)(t),function:pe(t=>"function"==typeof t?t:void 0)(t),constant:e=>pe(t=>t===e?e:void 0)(t),raw:pe(t=>t)(t),object:e=>pe(t=>{var i;if(null!==(i=t)&&"object"==typeof i)return function(t,e){return Object.keys(e).reduce((i,s)=>{if(void 0===i)return;const n=(0,e[s])(t[s]);return n.succeeded?Object.assign(Object.assign({},i),{[s]:n.value}):void 0},{})}(t,e)})(t),array:e=>pe(t=>{var i;if(Array.isArray(t))return i=e,t.reduce((t,e)=>{if(void 0===t)return;const s=i(e);return s.succeeded&&void 0!==s.value?[...t,s.value]:void 0},[])})(t)}}const ue={optional:ce(!0),required:ce(!1)};function de(t,e){const i=e(ue),s=ue.required.object(i)(t);return s.succeeded?s.value:void 0}function ve(t,e,i,s){if(e&&!e(t))return!1;const n=de(t,i);return!!n&&s(n)}function me(t,e){var i;return ht(null!==(i=null==t?void 0:t())&&void 0!==i?i:{},e)}function ge(t){return"value"in t}function be(t){if(!ot(t)||!("binding"in t))return!1;return pt(t.binding)}const fe="http://www.w3.org/2000/svg";function _e(t){t.offsetHeight}function we(t){return void 0!==t.ontouchstart}function xe(){return globalThis.document}const ye={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function Ce(t,e){const i=t.createElementNS(fe,"svg");return i.innerHTML=ye[e],i}function Ee(t,e,i){t.insertBefore(e,t.children[i])}function Pe(t){t.parentElement&&t.parentElement.removeChild(t)}function ke(t){for(;t.children.length>0;)t.removeChild(t.children[0])}function Me(t){return t.relatedTarget?t.relatedTarget:"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}function Ve(t,e){t.emitter.on("change",t=>{e(t.rawValue)}),e(t.rawValue)}function Ae(t,e,i){Ve(t.value(e),i)}const Se="tp";function Te(t){return(e,i)=>[Se,"-",t,"v",e?`_${e}`:"",i?`-${i}`:""].join("")}const Le=Te("lbl");class Re{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Le()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(Le("l")),Ae(e.props,"label",e=>{rt(e)?this.element.classList.add(Le(void 0,"nol")):(this.element.classList.remove(Le(void 0,"nol")),function(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}(i),i.appendChild(function(t,e){const i=t.createDocumentFragment();return e.split("\n").map(e=>t.createTextNode(e)).forEach((e,s)=>{s>0&&i.appendChild(t.createElement("br")),i.appendChild(e)}),i}(t,e)))}),this.element.appendChild(i),this.labelElement=i;const s=t.createElement("div");s.classList.add(Le("v")),this.element.appendChild(s),this.valueElement=s}}class De{constructor(t,e){this.props=e.props,this.valueController=e.valueController,this.viewProps=e.valueController.viewProps,this.view=new Re(t,{props:e.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(t){return ve(t,null,t=>({label:t.optional.string}),t=>(this.props.set("label",t.label),!0))}exportProps(){return me(null,{label:this.props.get("label")})}}const Fe=Te(""),Oe={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class Ne{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",()=>{["veryfirst","first","last","verylast"].forEach(t=>{e.classList.remove(Fe(void 0,Oe[t]))}),this.blade.get("positions").forEach(t=>{e.classList.add(Fe(void 0,Oe[t]))})}),this.viewProps.handleDispose(()=>{Pe(e)})}get parent(){return this.parent_}set parent(t){this.parent_=t,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(t){return ve(t,null,t=>({disabled:t.required.boolean,hidden:t.required.boolean}),t=>(this.viewProps.importState(t),!0))}exportState(){return me(null,Object.assign({},this.viewProps.exportState()))}}class Be extends Ne{constructor(t,e){if(e.value!==e.valueController.value)throw ut.shouldNeverHappen();const i=e.valueController.viewProps,s=new De(t,{blade:e.blade,props:e.props,valueController:e.valueController});super(Object.assign(Object.assign({},e),{view:new Re(t,{props:e.props,viewProps:i}),viewProps:i})),this.labelController=s,this.value=e.value,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}importState(t){return ve(t,e=>{var i,s,n;return super.importState(e)&&this.labelController.importProps(e)&&(null===(n=null===(s=(i=this.valueController).importProps)||void 0===s?void 0:s.call(i,t))||void 0===n||n)},t=>({value:t.optional.raw}),t=>(t.value&&(this.value.rawValue=t.value),!0))}exportState(){var t,e,i;return me(()=>super.exportState(),Object.assign(Object.assign({value:this.value.rawValue},this.labelController.exportProps()),null!==(i=null===(e=(t=this.valueController).exportProps)||void 0===e?void 0:e.call(t))&&void 0!==i?i:{}))}}function je(t){const e=Object.assign({},t);return delete e.value,e}class Ie extends Be{constructor(t,e){super(t,e),this.tag=e.tag}importState(t){return ve(t,e=>super.importState(je(t)),t=>({tag:t.optional.string}),t=>(this.tag=t.tag,!0))}exportState(){return me(()=>je(super.exportState()),{binding:{key:this.value.binding.target.key,value:this.value.binding.target.read()},tag:this.tag})}}class Ue extends Ie{importState(t){return ve(t,t=>super.importState(t),t=>({binding:t.required.object({value:t.required.raw})}),t=>(this.value.binding.inject(t.binding.value),this.value.fetch(),!0))}}function ze(t){return ge(t)&&function(t){if(!("binding"in t))return!1;const e=t.binding;return pt(e)&&"read"in e&&"write"in e}(t.value)}function Ke(t,e){for(;t.length<e;)t.push(void 0)}function qe(t){const e=t.indexOf(void 0);return e<0?t:t.slice(0,e)}class Ge{constructor(t){this.emitter=new vt,this.onTick_=this.onTick_.bind(this),this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.binding=t.binding,this.value_=ft(function(t){const e=[];return Ke(e,t),e}(t.bufferSize)),this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_),this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.fetch()}get rawValue(){return this.value_.rawValue}set rawValue(t){this.value_.rawValue=t}setRawValue(t,e){this.value_.setRawValue(t,e)}fetch(){this.value_.rawValue=function(t,e){const i=[...qe(t),e];return i.length>t.length?i.splice(0,i.length-t.length):Ke(i,t.length),i}(this.value_.rawValue,this.binding.read())}onTick_(){this.fetch()}onValueBeforeChange_(t){this.emitter.emit("beforechange",Object.assign(Object.assign({},t),{sender:this}))}onValueChange_(t){this.emitter.emit("change",Object.assign(Object.assign({},t),{sender:this}))}}class He extends Ie{exportState(){return me(()=>super.exportState(),{binding:{readonly:!0}})}}function $e(t){return ge(t)&&function(t){if(!("binding"in t))return!1;const e=t.binding;return pt(e)&&"read"in e&&!("write"in e)}(t.value)}class Xe extends ie{get label(){return this.controller.labelController.props.get("label")}set label(t){this.controller.labelController.props.set("label",t)}get title(){var t;return null!==(t=this.controller.buttonController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller.buttonController.props.set("title",t)}on(t,e){const i=e.bind(this);return this.controller.buttonController.emitter.on(t,t=>{i(new ae(this,t.nativeEvent))}),this}off(t,e){return this.controller.buttonController.emitter.off(t,e),this}}function Ye(t,e){return i=>{!function(t,e,i){i?t.classList.add(e):t.classList.remove(e)}(t,e,i)}}function We(t,e){Ve(t,t=>{e.textContent=null!=t?t:""})}const Ze=Te("btn");class Qe{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Ze()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("button");i.classList.add(Ze("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=t.createElement("div");s.classList.add(Ze("t")),We(e.props.value("title"),s),this.buttonElement.appendChild(s)}}class Je{constructor(t,e){this.emitter=new vt,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new Qe(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(t){return ve(t,null,t=>({title:t.optional.string}),t=>(this.props.set("title",t.title),!0))}exportProps(){return me(null,{title:this.props.get("title")})}onClick_(t){this.emitter.emit("click",{nativeEvent:t,sender:this})}}class ti extends Ne{constructor(t,e){const i=new Je(t,{props:e.buttonProps,viewProps:e.viewProps}),s=new De(t,{blade:e.blade,props:e.labelProps,valueController:i});super({blade:e.blade,view:s.view,viewProps:e.viewProps}),this.buttonController=i,this.labelController=s}importState(t){return ve(t,t=>super.importState(t)&&this.buttonController.importProps(t)&&this.labelController.importProps(t),()=>({}),()=>!0)}exportState(){return me(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}}class ei{constructor(t){const[e,i]=t.split("-"),s=e.split(".");this.major=parseInt(s[0],10),this.minor=parseInt(s[1],10),this.patch=parseInt(s[2],10),this.prerelease=null!=i?i:null}toString(){const t=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[t,this.prerelease].join("-"):t}}const ii=new ei("2.0.5");function si(t){return Object.assign({core:ii},t)}const ni=si({id:"button",type:"blade",accept(t){const e=de(t,t=>({title:t.required.string,view:t.required.constant("button"),label:t.optional.string}));return e?{params:e}:null},controller:t=>new ti(t.document,{blade:t.blade,buttonProps:_t.fromObject({title:t.params.title}),labelProps:_t.fromObject({label:t.params.label}),viewProps:t.viewProps}),api:t=>t.controller instanceof ti?new Xe(t.controller):null});class ri{constructor(t,e){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=t,this.emitter_=new vt,this.pool_=e;this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(t=>this.pool_.createApi(t))}addBinding(t,e,i){const s=null!=i?i:{},n=this.controller_.element.ownerDocument,r=this.pool_.createBinding(n,function(t,e){if(!dt.isBindable(t))throw ut.notBindable();return new dt(t,e)}(t,e),s),o=this.pool_.createBindingApi(r);return this.add(o,s.index)}addFolder(t){return function(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}(this,t)}addButton(t){return function(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}(this,t)}addTab(t){return function(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}(this,t)}add(t,e){const i=t.controller;return this.controller_.rack.add(i,e),t}remove(t){this.controller_.rack.remove(t.controller)}addBlade(t){const e=this.controller_.element.ownerDocument,i=this.pool_.createBlade(e,t),s=this.pool_.createApi(i);return this.add(s,t.index)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,t=>{i(t)},{key:e}),this}off(t,e){return this.emitter_.off(t,e),this}refresh(){this.children.forEach(t=>{var e;ot(e=t)&&"refresh"in e&&"function"==typeof e.refresh&&t.refresh()})}onRackValueChange_(t){const e=t.bladeController,i=this.pool_.createApi(e),s=be(e.value)?e.value.binding:null;this.emitter_.emit("change",new ne(i,s?s.target.read():e.value.rawValue,t.options.last))}}class oi extends ie{constructor(t,e){super(t),this.rackApi_=new ri(t.rackController,e)}refresh(){this.rackApi_.refresh()}}class ai extends Ne{constructor(t){super({blade:t.blade,view:t.view,viewProps:t.rackController.viewProps}),this.rackController=t.rackController}importState(t){return ve(t,t=>super.importState(t),t=>({children:t.required.array(t.required.raw)}),t=>this.rackController.rack.children.every((e,i)=>e.importState(t.children[i])))}exportState(){return me(()=>super.exportState(),{children:this.rackController.rack.children.map(t=>t.exportState())})}}function li(t){return"rackController"in t}class hi{constructor(t){this.emitter=new vt,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=t}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(t){for(const e of this.allItems())if(t(e))return e;return null}includes(t){return this.cache_.has(t)}add(t,e){if(this.includes(t))throw ut.shouldNeverHappen();const i=void 0!==e?e:this.items_.length;this.items_.splice(i,0,t),this.cache_.add(t);const s=this.extract_(t);s&&(s.emitter.on("add",this.onSubListAdd_),s.emitter.on("remove",this.onSubListRemove_),s.allItems().forEach(t=>{this.cache_.add(t)})),this.emitter.emit("add",{index:i,item:t,root:this,target:this})}remove(t){const e=this.items_.indexOf(t);if(e<0)return;this.items_.splice(e,1),this.cache_.delete(t);const i=this.extract_(t);i&&(i.allItems().forEach(t=>{this.cache_.delete(t)}),i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:e,item:t,root:this,target:this})}onSubListAdd_(t){this.cache_.add(t.item),this.emitter.emit("add",{index:t.index,item:t.item,root:this,target:t.target})}onSubListRemove_(t){this.cache_.delete(t.item),this.emitter.emit("remove",{index:t.index,item:t.item,root:this,target:t.target})}}function pi(t){return li(t)?t.rackController.rack.bcSet_:null}class ci{constructor(t){var e,i;this.emitter=new vt,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=null!==(e=t.blade)&&void 0!==e?e:null,null===(i=this.blade_)||void 0===i||i.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=t.viewProps,this.bcSet_=new hi(pi),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(t,e){var i;null===(i=t.parent)||void 0===i||i.remove(t),t.parent=this,this.bcSet_.add(t,e)}remove(t){t.parent=null,this.bcSet_.remove(t)}find(t){return this.bcSet_.allItems().filter(t)}onSetAdd_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("add",{bladeController:t.item,index:t.index,root:e,sender:this}),!e)return;const i=t.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),ge(i))i.value.emitter.on("change",this.onChildValueChange_);else if(li(i)){const t=i.rackController.rack;if(t){const e=t.emitter;e.on("layout",this.onRackLayout_),e.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("remove",{bladeController:t.item,root:e,sender:this}),!e)return;const i=t.item;if(ge(i))i.value.emitter.off("change",this.onChildValueChange_);else if(li(i)){const t=i.rackController.rack;if(t){const e=t.emitter;e.off("layout",this.onRackLayout_),e.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const t=this.bcSet_.items.filter(t=>!t.viewProps.get("hidden")),e=t[0],i=t[t.length-1];this.bcSet_.items.forEach(t=>{const s=[];t===e&&(s.push("first"),this.blade_&&!this.blade_.get("positions").includes("veryfirst")||s.push("veryfirst")),t===i&&(s.push("last"),this.blade_&&!this.blade_.get("positions").includes("verylast")||s.push("verylast")),t.blade.set("positions",s)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(t=>t.viewProps.get("disposed")).forEach(t=>{this.bcSet_.remove(t)})}onChildValueChange_(t){const e=function(t,e){for(let i=0;i<t.length;i++){const s=t[i];if(ge(s)&&s.value===e)return s}return null}(this.find(ge),t.sender);if(!e)throw ut.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:e,options:t.options,sender:this})}onRackLayout_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(t){this.emitter.emit("valuechange",{bladeController:t.bladeController,options:t.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class ui{constructor(t){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=t.element,this.viewProps=t.viewProps;const e=new ci({blade:t.root?void 0:t.blade,viewProps:t.viewProps});e.emitter.on("add",this.onRackAdd_),e.emitter.on("remove",this.onRackRemove_),this.rack=e,this.viewProps.handleDispose(()=>{for(let t=this.rack.children.length-1;t>=0;t--){this.rack.children[t].viewProps.set("disposed",!0)}})}onRackAdd_(t){t.root&&Ee(this.element,t.bladeController.view.element,t.index)}onRackRemove_(t){t.root&&Pe(t.bladeController.view.element)}}function di(){return new _t({positions:ft([],{equals:lt})})}class vi extends _t{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=_t.createCore(e);return new vi(i)}get styleExpanded(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!rt(t)?`${t}px`:"auto"}bindExpandedClass(t,e){const i=()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)};Ae(this,"expanded",i),Ae(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function mi(t,e){e.style.height=t.styleHeight}function gi(t,e){t.value("expanded").emitter.on("beforechange",()=>{if(t.set("completed",!1),rt(t.get("expandedHeight"))){const i=function(t,e){let i=0;return function(t,e){const i=t.style.transition;t.style.transition="none",e(),t.style.transition=i}(e,()=>{t.set("expandedHeight",null),t.set("temporaryExpanded",!0),_e(e),i=e.clientHeight,t.set("temporaryExpanded",null),_e(e)}),i}(t,e);i>0&&t.set("expandedHeight",i)}t.set("shouldFixHeight",!0),_e(e)}),t.emitter.on("change",()=>{mi(t,e)}),mi(t,e),e.addEventListener("transitionend",e=>{"height"===e.propertyName&&t.cleanUpTransition()})}class bi extends oi{constructor(t,e){super(t,e),this.emitter_=new vt,this.controller.foldable.value("expanded").emitter.on("change",t=>{this.emitter_.emit("fold",new re(this,t.sender.rawValue))}),this.rackApi_.on("change",t=>{this.emitter_.emit("change",t)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(t){this.controller.foldable.set("expanded",t)}get title(){return this.controller.props.get("title")}set title(t){this.controller.props.set("title",t)}get children(){return this.rackApi_.children}addBinding(t,e,i){return this.rackApi_.addBinding(t,e,i)}addFolder(t){return this.rackApi_.addFolder(t)}addButton(t){return this.rackApi_.addButton(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){return this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addBlade(t){return this.rackApi_.addBlade(t)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,t=>{i(t)},{key:e}),this}off(t,e){return this.emitter_.off(t,e),this}}const fi=Te("cnt");class _i{constructor(t,e){var i;this.className_=Te(null!==(i=e.viewName)&&void 0!==i?i:"fld"),this.element=t.createElement("div"),this.element.classList.add(this.className_(),fi()),e.viewProps.bindClassModifiers(this.element),this.foldable_=e.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),Ae(this.foldable_,"completed",Ye(this.element,this.className_(void 0,"cpl")));const s=t.createElement("button");s.classList.add(this.className_("b")),Ae(e.props,"title",t=>{rt(t)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),e.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;const n=t.createElement("div");n.classList.add(this.className_("i")),this.element.appendChild(n);const r=t.createElement("div");r.classList.add(this.className_("t")),We(e.props.value("title"),r),this.buttonElement.appendChild(r),this.titleElement=r;const o=t.createElement("div");o.classList.add(this.className_("m")),this.buttonElement.appendChild(o);const a=t.createElement("div");a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}}class wi extends ai{constructor(t,e){var i;const s=vi.create(null===(i=e.expanded)||void 0===i||i),n=new _i(t,{foldable:s,props:e.props,viewName:e.root?"rot":void 0,viewProps:e.viewProps});super(Object.assign(Object.assign({},e),{rackController:new ui({blade:e.blade,element:n.containerElement,root:e.root,viewProps:e.viewProps}),view:n})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=e.props,this.foldable=s,gi(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(t){return ve(t,t=>super.importState(t),t=>({expanded:t.required.boolean,title:t.optional.string}),t=>(this.foldable.set("expanded",t.expanded),this.props.set("title",t.title),!0))}exportState(){return me(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const xi=si({id:"folder",type:"blade",accept(t){const e=de(t,t=>({title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean}));return e?{params:e}:null},controller:t=>new wi(t.document,{blade:t.blade,expanded:t.params.expanded,props:_t.fromObject({title:t.params.title}),viewProps:t.viewProps}),api:t=>t.controller instanceof wi?new bi(t.controller,t.pool):null}),yi=Te("");function Ci(t,e){return Ye(t,yi(void 0,e))}class Ei extends _t{constructor(t){var e,i;super(t),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=(i=ft(this.getGlobalDisabled_()),[new bt(i),(t,e)=>{i.setRawValue(t,e)}]),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),null===(e=this.get("parent"))||void 0===e||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(t){var e,i,s;const n=null!=t?t:{};return new Ei(_t.createCore({disabled:null!==(e=n.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(i=n.hidden)&&void 0!==i&&i,parent:null!==(s=n.parent)&&void 0!==s?s:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(t){Ve(this.globalDisabled_,Ci(t,"disabled")),Ae(this,"hidden",Ci(t,"hidden"))}bindDisabled(t){Ve(this.globalDisabled_,e=>{t.disabled=e})}bindTabIndex(t){Ve(this.globalDisabled_,e=>{t.tabIndex=e?-1:0})}handleDispose(t){this.value("disposed").emitter.on("change",e=>{e&&t()})}importState(t){this.set("disabled",t.disabled),this.set("hidden",t.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const t=this.get("parent");return!!t&&t.globalDisabled.rawValue||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(t){var e;const i=t.previousRawValue;null==i||i.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),null===(e=this.get("parent"))||void 0===e||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}const Pi=Te("tbp");class ki{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Pi()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(Pi("c")),this.element.appendChild(i),this.containerElement=i}}const Mi=Te("tbi");class Vi{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Mi()),e.viewProps.bindClassModifiers(this.element),Ae(e.props,"selected",t=>{t?this.element.classList.add(Mi(void 0,"sel")):this.element.classList.remove(Mi(void 0,"sel"))});const i=t.createElement("button");i.classList.add(Mi("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=t.createElement("div");s.classList.add(Mi("t")),We(e.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s}}class Ai{constructor(t,e){this.emitter=new vt,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new Vi(t,{props:e.props,viewProps:e.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class Si extends ai{constructor(t,e){const i=new ki(t,{viewProps:e.viewProps});super(Object.assign(Object.assign({},e),{rackController:new ui({blade:e.blade,element:i.containerElement,viewProps:e.viewProps}),view:i})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Ai(t,{props:e.itemProps,viewProps:Ei.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=e.props,Ae(this.props,"selected",t=>{this.itemController.props.set("selected",t),this.viewProps.set("hidden",!t)})}get itemController(){return this.ic_}importState(t){return ve(t,t=>super.importState(t),t=>({selected:t.required.boolean,title:t.required.string}),t=>(this.ic_.props.set("selected",t.selected),this.ic_.props.set("title",t.title),!0))}exportState(){return me(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}}class Ti extends oi{constructor(t,e){super(t,e),this.emitter_=new vt,this.onSelect_=this.onSelect_.bind(this),this.pool_=e,this.rackApi_.on("change",t=>{this.emitter_.emit("change",t)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(t){const e=this.controller.view.element.ownerDocument,i=new Si(e,{blade:di(),itemProps:_t.fromObject({selected:!1,title:t.title}),props:_t.fromObject({selected:!1}),viewProps:Ei.create()}),s=this.pool_.createApi(i);return this.rackApi_.add(s,t.index)}removePage(t){this.rackApi_.remove(this.rackApi_.children[t])}on(t,e){const i=e.bind(this);return this.emitter_.on(t,t=>{i(t)},{key:e}),this}off(t,e){return this.emitter_.off(t,e),this}onSelect_(t){this.emitter_.emit("select",new oe(this,t.rawValue))}}class Li extends oi{get title(){var t;return null!==(t=this.controller.itemController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller.itemController.props.set("title",t)}get selected(){return this.controller.props.get("selected")}set selected(t){this.controller.props.set("selected",t)}get children(){return this.rackApi_.children}addButton(t){return this.rackApi_.addButton(t)}addFolder(t){return this.rackApi_.addFolder(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addBinding(t,e,i){return this.rackApi_.addBinding(t,e,i)}addBlade(t){return this.rackApi_.addBlade(t)}}class Ri{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=ft(!0),this.selectedIndex=ft(-1),this.items_=[]}add(t,e){const i=null!=e?e:this.items_.length;this.items_.splice(i,0,t),t.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(t){const e=this.items_.indexOf(t);e<0||(this.items_.splice(e,1),t.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(0===this.items_.length)return this.selectedIndex.rawValue=-1,void(this.empty.rawValue=!0);const t=this.items_.findIndex(t=>t.rawValue);t<0?(this.items_.forEach((t,e)=>{t.rawValue=0===e}),this.selectedIndex.rawValue=0):(this.items_.forEach((e,i)=>{e.rawValue=i===t}),this.selectedIndex.rawValue=t),this.empty.rawValue=!1}onItemSelectedChange_(t){if(t.rawValue){const e=this.items_.findIndex(e=>e===t.sender);this.items_.forEach((t,i)=>{t.rawValue=i===e}),this.selectedIndex.rawValue=e}else this.keepSelection_()}}const Di=Te("tab");class Fi{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Di(),fi()),e.viewProps.bindClassModifiers(this.element),Ve(e.empty,Ye(this.element,Di(void 0,"nop")));const i=t.createElement("div");i.classList.add(Di("t")),this.element.appendChild(i),this.itemsElement=i;const s=t.createElement("div");s.classList.add(Di("i")),this.element.appendChild(s);const n=t.createElement("div");n.classList.add(Di("c")),this.element.appendChild(n),this.contentsElement=n}}class Oi extends ai{constructor(t,e){const i=new Ri,s=new Fi(t,{empty:i.empty,viewProps:e.viewProps});super({blade:e.blade,rackController:new ui({blade:e.blade,element:s.contentsElement,viewProps:e.viewProps}),view:s}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const n=this.rackController.rack;n.emitter.on("add",this.onRackAdd_),n.emitter.on("remove",this.onRackRemove_),this.tab=i}add(t,e){this.rackController.rack.add(t,e)}remove(t){this.rackController.rack.remove(this.rackController.rack.children[t])}onRackAdd_(t){if(!t.root)return;const e=t.bladeController;Ee(this.view.itemsElement,e.itemController.view.element,t.index),e.itemController.viewProps.set("parent",this.viewProps),this.tab.add(e.props.value("selected"))}onRackRemove_(t){if(!t.root)return;const e=t.bladeController;Pe(e.itemController.view.element),e.itemController.viewProps.set("parent",null),this.tab.remove(e.props.value("selected"))}}const Ni=si({id:"tab",type:"blade",accept(t){const e=de(t,t=>({pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")}));return e&&0!==e.pages.length?{params:e}:null},controller(t){const e=new Oi(t.document,{blade:t.blade,viewProps:t.viewProps});return t.params.pages.forEach(i=>{const s=new Si(t.document,{blade:di(),itemProps:_t.fromObject({selected:!1,title:i.title}),props:_t.fromObject({selected:!1}),viewProps:Ei.create()});e.add(s)}),e},api:t=>t.controller instanceof Oi?new Ti(t.controller,t.pool):t.controller instanceof Si?new Li(t.controller,t.pool):null});class Bi extends le{get options(){return this.controller.valueController.props.get("options")}set options(t){this.controller.valueController.props.set("options",t)}}class ji{constructor(){this.disabled=!1,this.emitter=new vt}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class Ii{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new vt,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class Ui{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce((t,e)=>e.constrain(t),t)}}function zi(t,e){if(t instanceof e)return t;if(t instanceof Ui){const i=t.constraints.reduce((t,i)=>t||(i instanceof e?i:null),null);if(i)return i}return null}class Ki{constructor(t){this.values=_t.fromObject({options:t})}constrain(t){const e=this.values.get("options");if(0===e.length)return t;return e.filter(e=>e.value===t).length>0?t:e[0].value}}function qi(t){var e;const i=ue;return Array.isArray(t)?null===(e=de({items:t},t=>({items:t.required.array(t.required.object({text:t.required.string,value:t.required.raw}))})))||void 0===e?void 0:e.items:"object"==typeof t?i.required.raw(t).value:void 0}function Gi(t){if(Array.isArray(t))return t;const e=[];return Object.keys(t).forEach(i=>{e.push({text:i,value:t[i]})}),e}function Hi(t){return rt(t)?null:new Ki(Gi(t))}const $i=Te("lst");class Xi{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.props_=e.props,this.element=t.createElement("div"),this.element.classList.add($i()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("select");i.classList.add($i("s")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const s=t.createElement("div");s.classList.add($i("m")),s.appendChild(Ce(t,"dropdown")),this.element.appendChild(s),e.value.emitter.on("change",this.onValueChange_),this.value_=e.value,Ae(this.props_,"options",e=>{ke(this.selectElement),e.forEach(e=>{const i=t.createElement("option");i.textContent=e.text,this.selectElement.appendChild(i)}),this.update_()})}update_(){const t=this.props_.get("options").map(t=>t.value);this.selectElement.selectedIndex=t.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class Yi{constructor(t,e){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new Xi(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(t){const e=t.currentTarget;this.value.rawValue=this.props.get("options")[e.selectedIndex].value}importProps(t){return ve(t,null,t=>({options:t.required.custom(qi)}),t=>(this.props.set("options",Gi(t.options)),!0))}exportProps(){return me(null,{options:this.props.get("options")})}}const Wi=Te("pop");class Zi{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Wi()),e.viewProps.bindClassModifiers(this.element),Ve(e.shows,Ye(this.element,Wi(void 0,"v")))}}class Qi{constructor(t,e){this.shows=ft(!1),this.viewProps=e.viewProps,this.view=new Zi(t,{shows:this.shows,viewProps:this.viewProps})}}const Ji=Te("txt");class ts{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Ji()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const i=t.createElement("input");i.classList.add(Ji("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}}class es{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new ts(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget.value,i=this.parser_(e);rt(i)||(this.value.rawValue=i),this.view.refresh()}}function is(t){return"false"!==t&&!!t}function ss(t){return function(t){return String(t)}(t)}const ns=Kt(0);function rs(t){return ns(t)+"%"}function os(t){return String(t)}function as(t){return t}function ls({primary:t,secondary:e,forward:i,backward:s}){let n=!1;function r(t){n||(n=!0,t(),n=!1)}t.emitter.on("change",s=>{r(()=>{e.setRawValue(i(t.rawValue,e.rawValue),s.options)})}),e.emitter.on("change",n=>{r(()=>{t.setRawValue(s(t.rawValue,e.rawValue),n.options)}),r(()=>{e.setRawValue(i(t.rawValue,e.rawValue),n.options)})}),r(()=>{e.setRawValue(i(t.rawValue,e.rawValue),{forceEmit:!1,last:!0})})}function hs(t,e){const i=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+i:e.downKey?-i:0}function ps(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function cs(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function us(t){return function(t){return"ArrowUp"===t||"ArrowDown"===t}(t)||"ArrowLeft"===t||"ArrowRight"===t}function ds(t,e){var i,s;const n=e.ownerDocument.defaultView,r=e.getBoundingClientRect();return{x:t.pageX-((null!==(i=n&&n.scrollX)&&void 0!==i?i:0)+r.left),y:t.pageY-((null!==(s=n&&n.scrollY)&&void 0!==s?s:0)+r.top)}}class vs{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new vt,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(ds(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(ds(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(ds(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const i=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,s=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(i?{x:i.clientX-s.left,y:i.clientY-s.top}:void 0),sender:this,shiftKey:t.shiftKey})}}const ms=Te("txt");class gs{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(ms(),ms(void 0,"num")),e.arrayPosition&&this.element.classList.add(ms(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("input");i.classList.add(ms("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(ms()),this.inputElement.classList.add(ms("i"));const s=t.createElement("div");s.classList.add(ms("k")),this.element.appendChild(s),this.knobElement=s;const n=t.createElementNS(fe,"svg");n.classList.add(ms("g")),this.knobElement.appendChild(n);const r=t.createElementNS(fe,"path");r.classList.add(ms("gb")),n.appendChild(r),this.guideBodyElem_=r;const o=t.createElementNS(fe,"path");o.classList.add(ms("gh")),n.appendChild(o),this.guideHeadElem_=o;const a=t.createElement("div");a.classList.add(Te("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(null===t.rawValue)return void this.element.classList.remove(ms(void 0,"drg"));this.element.classList.add(ms(void 0,"drg"));const e=t.rawValue/this.props_.get("pointerScale"),i=e+(e>0?-1:e<0?1:0),s=Ht(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+s},0 L${i},4 L${i+s},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const n=this.props_.get("formatter");this.tooltipElem_.textContent=n(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class bs{constructor(t,e){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=e.parser,this.props=e.props,this.sliderProps_=null!==(i=e.sliderProps)&&void 0!==i?i:null,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=ft(null),this.view=new gs(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const s=new vs(this.view.knobElement);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}constrainValue_(t){var e,i;const s=null===(e=this.sliderProps_)||void 0===e?void 0:e.get("min"),n=null===(i=this.sliderProps_)||void 0===i?void 0:i.get("max");let r=t;return void 0!==s&&(r=Math.max(r,s)),void 0!==n&&(r=Math.min(r,n)),r}onInputChange_(t){const e=t.currentTarget.value,i=this.parser_(e);rt(i)||(this.value.rawValue=this.constrainValue_(i)),this.view.refresh()}onInputKeyDown_(t){const e=hs(this.props.get("keyScale"),ps(t));0!==e&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+e),{forceEmit:!1,last:!1})}onInputKeyUp_(t){0!==hs(this.props.get("keyScale"),ps(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.constrainValue_(this.originRawValue_+e*this.props.get("pointerScale"))}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const fs=Te("sld");class _s{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(fs()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(fs("t")),e.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const s=t.createElement("div");s.classList.add(fs("k")),this.trackElement.appendChild(s),this.knobElement=s,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.update_()}update_(){const t=Ht(qt(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${t}%`}onChange_(){this.update_()}}class ws{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.props=e.props,this.view=new _s(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new vs(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){t.point&&this.value.setRawValue(qt(Ht(t.point.x,0,t.bounds.width),0,t.bounds.width,this.props.get("min"),this.props.get("max")),e)}onPointerDownOrMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=hs(this.props.get("keyScale"),cs(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onKeyUp_(t){0!==hs(this.props.get("keyScale"),cs(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const xs=Te("sldtxt");class ys{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(xs());const i=t.createElement("div");i.classList.add(xs("s")),this.sliderView_=e.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const s=t.createElement("div");s.classList.add(xs("t")),this.textView_=e.textView,s.appendChild(this.textView_.element),this.element.appendChild(s)}}class Cs{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sliderC_=new ws(t,{props:e.sliderProps,value:e.value,viewProps:this.viewProps}),this.textC_=new bs(t,{parser:e.parser,props:e.textProps,sliderProps:e.sliderProps,value:e.value,viewProps:e.viewProps}),this.view=new ys(t,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(t){return ve(t,null,t=>({max:t.required.number,min:t.required.number}),t=>{const e=this.sliderC_.props;return e.set("max",t.max),e.set("min",t.min),!0})}exportProps(){const t=this.sliderC_.props;return me(null,{max:t.get("max"),min:t.get("min")})}}function Es(t){return{sliderProps:new _t({keyScale:t.keyScale,max:t.max,min:t.min}),textProps:new _t({formatter:ft(t.formatter),keyScale:t.keyScale,pointerScale:ft(t.pointerScale)})}}const Ps={containerUnitSize:"cnt-usz"};function ks(t){return`--${Ps[t]}`}function Ms(t){return te(t)}function Vs(t){if(at(t))return de(t,Ms)}function As(t,e){if(!t)return;const i=[],s=Zt(t,e);s&&i.push(s);const n=Qt(t);return n&&i.push(n),new Ui(i)}function Ss(t){if("inline"===t||"popup"===t)return t}function Ts(t,e){t.write(e)}const Ls=Te("ckb");class Rs{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Ls()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("label");i.classList.add(Ls("l")),this.element.appendChild(i),this.labelElement=i;const s=t.createElement("input");s.classList.add(Ls("i")),s.type="checkbox",this.labelElement.appendChild(s),this.inputElement=s,e.viewProps.bindDisabled(this.inputElement);const n=t.createElement("div");n.classList.add(Ls("w")),this.labelElement.appendChild(n);const r=Ce(t,"check");n.appendChild(r),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class Ds{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.onLabelMouseDown_=this.onLabelMouseDown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Rs(t,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.labelElement.addEventListener("mousedown",this.onLabelMouseDown_)}onInputChange_(t){const e=t.currentTarget;this.value.rawValue=e.checked,t.preventDefault(),t.stopPropagation()}onLabelMouseDown_(t){t.preventDefault()}}const Fs=si({id:"input-bool",type:"input",accept:(t,e)=>{if("boolean"!=typeof t)return null;const i=de(e,t=>({options:t.optional.custom(qi),readonly:t.optional.constant(!1)}));return i?{initialValue:t,params:i}:null},binding:{reader:t=>is,constraint:t=>function(t){const e=[],i=Hi(t.options);return i&&e.push(i),new Ui(e)}(t.params),writer:t=>Ts},controller:t=>{const e=t.document,i=t.value,s=t.constraint,n=s&&zi(s,Ki);return n?new Yi(e,{props:new _t({options:n.values.value("options")}),value:i,viewProps:t.viewProps}):new Ds(e,{value:i,viewProps:t.viewProps})},api:t=>"boolean"!=typeof t.controller.value.rawValue?null:t.controller.valueController instanceof Yi?new Bi(t.controller):null}),Os=Te("col");class Ns{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Os()),e.foldable.bindExpandedClass(this.element,Os(void 0,"expanded")),Ae(e.foldable,"completed",Ye(this.element,Os(void 0,"cpl")));const i=t.createElement("div");i.classList.add(Os("h")),this.element.appendChild(i);const s=t.createElement("div");s.classList.add(Os("s")),i.appendChild(s),this.swatchElement=s;const n=t.createElement("div");if(n.classList.add(Os("t")),i.appendChild(n),this.textElement=n,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(Os("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}function Bs(t,e,i){const s=$t(t,360),n=Ht(e/100,0,1),r=Ht(i/100,0,1),o=r*n,a=o*(1-Math.abs(s/60%2-1)),l=r-o;let h,p,c;return[h,p,c]=s>=0&&s<60?[o,a,0]:s>=60&&s<120?[a,o,0]:s>=120&&s<180?[0,o,a]:s>=180&&s<240?[0,a,o]:s>=240&&s<300?[a,0,o]:[o,0,a],[255*(h+l),255*(p+l),255*(c+l)]}function js(t){return[t[0],t[1],t[2]]}function Is(t,e){return[t[0],t[1],t[2],e]}const Us={hsl:{hsl:(t,e,i)=>[t,e,i],hsv:function(t,e,i){const s=i+e*(100-Math.abs(2*i-100))/200;return[t,0!==s?e*(100-Math.abs(2*i-100))/s:0,i+e*(100-Math.abs(2*i-100))/200]},rgb:function(t,e,i){const s=(t%360+360)%360,n=Ht(e/100,0,1),r=Ht(i/100,0,1),o=(1-Math.abs(2*r-1))*n,a=o*(1-Math.abs(s/60%2-1)),l=r-o/2;let h,p,c;return[h,p,c]=s>=0&&s<60?[o,a,0]:s>=60&&s<120?[a,o,0]:s>=120&&s<180?[0,o,a]:s>=180&&s<240?[0,a,o]:s>=240&&s<300?[a,0,o]:[o,0,a],[255*(h+l),255*(p+l),255*(c+l)]}},hsv:{hsl:function(t,e,i){const s=100-Math.abs(i*(200-e)/100-100);return[t,0!==s?e*i/s:0,i*(200-e)/200]},hsv:(t,e,i)=>[t,e,i],rgb:Bs},rgb:{hsl:function(t,e,i){const s=Ht(t/255,0,1),n=Ht(e/255,0,1),r=Ht(i/255,0,1),o=Math.max(s,n,r),a=Math.min(s,n,r),l=o-a;let h=0,p=0;const c=(a+o)/2;return 0!==l&&(p=l/(1-Math.abs(o+a-1)),h=s===o?(n-r)/l:n===o?2+(r-s)/l:4+(s-n)/l,h=h/6+(h<0?1:0)),[360*h,100*p,100*c]},hsv:function(t,e,i){const s=Ht(t/255,0,1),n=Ht(e/255,0,1),r=Ht(i/255,0,1),o=Math.max(s,n,r),a=o-Math.min(s,n,r);let l;return l=0===a?0:o===s?((n-r)/a%6+6)%6*60:o===n?60*((r-s)/a+2):60*((s-n)/a+4),[l,100*(0===o?0:a/o),100*o]},rgb:(t,e,i)=>[t,e,i]}};function zs(t,e){return["float"===e?1:"rgb"===t?255:360,"float"===e?1:"rgb"===t?255:100,"float"===e?1:"rgb"===t?255:100]}function Ks(t,e,i){var s;const n=zs(e,i);return["rgb"===e?Ht(t[0],0,n[0]):(r=t[0],o=n[0],r===o?o:$t(r,o)),Ht(t[1],0,n[1]),Ht(t[2],0,n[2]),Ht(null!==(s=t[3])&&void 0!==s?s:1,0,1)];var r,o}function qs(t,e,i,s){const n=zs(e,i),r=zs(e,s);return t.map((t,e)=>t/n[e]*r[e])}function Gs(t,e,i){const s=qs(t,e.mode,e.type,"int");return qs(Us[e.mode][i.mode](...s),i.mode,"int",i.type)}class Hs{static black(){return new Hs([0,0,0],"rgb")}constructor(t,e){this.type="int",this.mode=e,this.comps_=Ks(t,e,this.type)}getComponents(t){return Is(Gs(js(this.comps_),{mode:this.mode,type:this.type},{mode:null!=t?t:this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const t=this.getComponents("rgb");return{r:t[0],g:t[1],b:t[2],a:t[3]}}}const $s=Te("colp");class Xs{constructor(t,e){this.alphaViews_=null,this.element=t.createElement("div"),this.element.classList.add($s()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add($s("hsv"));const s=t.createElement("div");s.classList.add($s("sv")),this.svPaletteView_=e.svPaletteView,s.appendChild(this.svPaletteView_.element),i.appendChild(s);const n=t.createElement("div");n.classList.add($s("h")),this.hPaletteView_=e.hPaletteView,n.appendChild(this.hPaletteView_.element),i.appendChild(n),this.element.appendChild(i);const r=t.createElement("div");if(r.classList.add($s("rgb")),this.textsView_=e.textsView,r.appendChild(this.textsView_.element),this.element.appendChild(r),e.alphaViews){this.alphaViews_={palette:e.alphaViews.palette,text:e.alphaViews.text};const i=t.createElement("div");i.classList.add($s("a"));const s=t.createElement("div");s.classList.add($s("ap")),s.appendChild(this.alphaViews_.palette.element),i.appendChild(s);const n=t.createElement("div");n.classList.add($s("at")),n.appendChild(this.alphaViews_.text.element),i.appendChild(n),this.element.appendChild(i)}}get allFocusableElements(){const t=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(t=>t.inputElement)];return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),t}}function Ys(t){return"int"===t?"int":"float"===t?"float":void 0}function Ws(t){return de(t,t=>({color:t.optional.object({alpha:t.optional.boolean,type:t.optional.custom(Ys)}),expanded:t.optional.boolean,picker:t.optional.custom(Ss),readonly:t.optional.constant(!1)}))}function Zs(t){return t?.1:1}function Qs(t){var e;return null===(e=t.color)||void 0===e?void 0:e.type}class Js{constructor(t,e){this.type="float",this.mode=e,this.comps_=Ks(t,e,this.type)}getComponents(t){return Is(Gs(js(this.comps_),{mode:this.mode,type:this.type},{mode:null!=t?t:this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const t=this.getComponents("rgb");return{r:t[0],g:t[1],b:t[2],a:t[3]}}}const tn={int:(t,e)=>new Hs(t,e),float:(t,e)=>new Js(t,e)};function en(t,e,i){return tn[i](t,e)}function sn(t,e){if(t.type===e)return t;if(function(t){return"int"===t.type}(t)&&"float"===e)return function(t){const e=t.getComponents(),i=zs(t.mode,"int");return new Js([qt(e[0],0,i[0],0,1),qt(e[1],0,i[1],0,1),qt(e[2],0,i[2],0,1),e[3]],t.mode)}(t);if(function(t){return"float"===t.type}(t)&&"int"===e)return function(t){const e=t.getComponents(),i=zs(t.mode,"int");return new Hs([Math.round(qt(e[0],0,1,0,i[0])),Math.round(qt(e[1],0,1,0,i[1])),Math.round(qt(e[2],0,1,0,i[2])),e[3]],t.mode)}(t);throw ut.shouldNeverHappen()}function nn(t,e){const i=t.match(/^(.+)%$/);return i?Math.min(.01*parseFloat(i[1])*e,e):Math.min(parseFloat(t),e)}const rn={deg:t=>t,grad:t=>360*t/400,rad:t=>360*t/(2*Math.PI),turn:t=>360*t};function on(t){const e=t.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(t);const i=parseFloat(e[1]),s=e[2];return rn[s](i)}function an(t){const e=t.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[nn(e[1],255),nn(e[2],255),nn(e[3],255)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function ln(t){const e=an(t);return e?new Hs(e,"rgb"):null}function hn(t){const e=t.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[nn(e[1],255),nn(e[2],255),nn(e[3],255),nn(e[4],1)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:i}function pn(t){const e=hn(t);return e?new Hs(e,"rgb"):null}function cn(t){const e=t.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[on(e[1]),nn(e[2],100),nn(e[3],100)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function un(t){const e=cn(t);return e?new Hs(e,"hsl"):null}function dn(t){const e=t.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[on(e[1]),nn(e[2],100),nn(e[3],100),nn(e[4],1)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:i}function vn(t){const e=dn(t);return e?new Hs(e,"hsl"):null}function mn(t){const e=t.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const i=t.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return i?[parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16)]:null}function gn(t){const e=mn(t);return e?new Hs(e,"rgb"):null}function bn(t){const e=t.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),qt(parseInt(e[4]+e[4],16),0,255,0,1)];const i=t.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return i?[parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16),qt(parseInt(i[4],16),0,255,0,1)]:null}function fn(t){const e=bn(t);return e?new Hs(e,"rgb"):null}function _n(t){const e=t.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const i=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function wn(t){return e=>{const i=_n(e);return i?en(i,"rgb",t):null}}function xn(t){const e=t.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const i=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:i}function yn(t){return e=>{const i=xn(e);return i?en(i,"rgb",t):null}}const Cn=[{parser:mn,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:bn,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:an,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:hn,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:cn,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:dn,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:_n,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:xn,result:{alpha:!0,mode:"rgb",notation:"object"}}];function En(t,e="int"){const i=function(t){return Cn.reduce((e,{parser:i,result:s})=>e||(i(t)?s:null),null)}(t);return i?"hex"===i.notation&&"float"!==e?Object.assign(Object.assign({},i),{type:"int"}):"func"===i.notation?Object.assign(Object.assign({},i),{type:e}):null:null}function Pn(t){const e=[gn,fn,ln,pn,un,vn];"int"===t&&e.push(wn("int"),yn("int")),"float"===t&&e.push(wn("float"),yn("float"));const i=function(t){return e=>t.reduce((t,i)=>null!==t?t:i(e),null)}(e);return e=>{const s=i(e);return s?sn(s,t):null}}function kn(t){const e=Pn("int");if("string"!=typeof t)return Hs.black();const i=e(t);return null!=i?i:Hs.black()}function Mn(t){const e=Ht(Math.floor(t),0,255).toString(16);return 1===e.length?`0${e}`:e}function Vn(t,e="#"){return`${e}${js(t.getComponents("rgb")).map(Mn).join("")}`}function An(t,e="#"){const i=t.getComponents("rgb");return`${e}${[i[0],i[1],i[2],255*i[3]].map(Mn).join("")}`}function Sn(t){const e=Kt(0);return`rgb(${js(sn(t,"int").getComponents("rgb")).map(t=>e(t)).join(", ")})`}function Tn(t){const e=Kt(2),i=Kt(0);return`rgba(${sn(t,"int").getComponents("rgb").map((t,s)=>(3===s?e:i)(t)).join(", ")})`}function Ln(t,e){const i=Kt("float"===e?2:0),s=["r","g","b"];return`{${js(sn(t,e).getComponents("rgb")).map((t,e)=>`${s[e]}: ${i(t)}`).join(", ")}}`}function Rn(t){return e=>Ln(e,t)}function Dn(t,e){const i=Kt(2),s=Kt("float"===e?2:0),n=["r","g","b","a"];return`{${sn(t,e).getComponents("rgb").map((t,e)=>`${n[e]}: ${(3===e?i:s)(t)}`).join(", ")}}`}function Fn(t){return e=>Dn(e,t)}const On=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:Vn},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:An},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:Sn},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:Tn},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:function(t){const e=[Kt(0),rs,rs];return`hsl(${js(sn(t,"int").getComponents("hsl")).map((t,i)=>e[i](t)).join(", ")})`}},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:function(t){const e=[Kt(0),rs,rs,Kt(2)];return`hsla(${sn(t,"int").getComponents("hsl").map((t,i)=>e[i](t)).join(", ")})`}},...["int","float"].reduce((t,e)=>[...t,{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:Rn(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:Fn(e)}],[])];function Nn(t){return On.reduce((e,i)=>{return e||(s=i.format,n=t,s.alpha===n.alpha&&s.mode===n.mode&&s.notation===n.notation&&s.type===n.type?i.stringifier:null);var s,n},null)}const Bn=Te("apl");class jn{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Bn()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const i=t.createElement("div");i.classList.add(Bn("b")),this.element.appendChild(i);const s=t.createElement("div");s.classList.add(Bn("c")),i.appendChild(s),this.colorElem_=s;const n=t.createElement("div");n.classList.add(Bn("m")),this.element.appendChild(n),this.markerElem_=n;const r=t.createElement("div");r.classList.add(Bn("p")),this.markerElem_.appendChild(r),this.previewElem_=r,this.update_()}update_(){const t=this.value.rawValue,e=t.getComponents("rgb"),i=new Hs([e[0],e[1],e[2],0],"rgb"),s=new Hs([e[0],e[1],e[2],255],"rgb"),n=["to right",Tn(i),Tn(s)];this.colorElem_.style.background=`linear-gradient(${n.join(",")})`,this.previewElem_.style.backgroundColor=Tn(t);const r=qt(e[3],0,1,0,100);this.markerElem_.style.left=`${r}%`}onValueChange_(){this.update_()}}class In{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new jn(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new vs(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=t.point.x/t.bounds.width,s=this.value.rawValue,[n,r,o]=s.getComponents("hsv");this.value.setRawValue(new Hs([n,r,o,i],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=hs(Zs(!0),cs(t));if(0===e)return;const i=this.value.rawValue,[s,n,r,o]=i.getComponents("hsv");this.value.setRawValue(new Hs([s,n,r,o+e],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==hs(Zs(!0),cs(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Un=Te("coltxt");class zn{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Un()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(Un("m")),this.modeElem_=function(t){const e=t.createElement("select");return e.appendChild([{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}].reduce((e,i)=>{const s=t.createElement("option");return s.textContent=i.text,s.value=i.value,e.appendChild(s),e},t.createDocumentFragment())),e}(t),this.modeElem_.classList.add(Un("ms")),i.appendChild(this.modeSelectElement),e.viewProps.bindDisabled(this.modeElem_);const s=t.createElement("div");s.classList.add(Un("mm")),s.appendChild(Ce(t,"dropdown")),i.appendChild(s),this.element.appendChild(i);const n=t.createElement("div");n.classList.add(Un("w")),this.element.appendChild(n),this.inputsElem_=n,this.inputViews_=e.inputViews,this.applyInputViews_(),Ve(e.mode,t=>{this.modeElem_.value=t})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(t){this.inputViews_=t,this.applyInputViews_()}applyInputViews_(){ke(this.inputsElem_);const t=this.element.ownerDocument;this.inputViews_.forEach(e=>{const i=t.createElement("div");i.classList.add(Un("c")),i.appendChild(e.element),this.inputsElem_.appendChild(i)})}}function Kn(t,e,i){const s=zs(t,e)[i];return new wt({min:0,max:s})}function qn(t,e){const i={colorMode:e.colorMode,colorType:e.colorType,parser:It,viewProps:e.viewProps};return[0,1,2].map(s=>{const n=function(t,e,i){return new bs(t,{arrayPosition:0===i?"fst":2===i?"lst":"mid",parser:e.parser,props:_t.fromObject({formatter:(s=e.colorType,Kt("float"===s?2:0)),keyScale:Zs(!1),pointerScale:"float"===e.colorType?.01:1}),value:ft(0,{constraint:Kn(e.colorMode,e.colorType,i)}),viewProps:e.viewProps});var s}(t,i,s);return ls({primary:e.value,secondary:n.value,forward:t=>sn(t,e.colorType).getComponents(e.colorMode)[s],backward(t,i){const n=e.colorMode,r=sn(t,e.colorType).getComponents(n);r[s]=i;return sn(en(Is(js(r),r[3]),n,e.colorType),"int")}}),n})}class Gn{constructor(t,e){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=e.colorType,this.value=e.value,this.viewProps=e.viewProps,this.colorMode=ft(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(t),this.view=new zn(t,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(t){const e=this.colorMode.rawValue;return function(t){return"hex"!==t}(e)?qn(t,{colorMode:e,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):function(t,e){const i=new es(t,{parser:Pn("int"),props:_t.fromObject({formatter:Vn}),value:ft(Hs.black()),viewProps:e.viewProps});return ls({primary:e.value,secondary:i.value,forward:t=>new Hs(js(t.getComponents()),t.mode),backward:(t,e)=>new Hs(Is(js(e.getComponents(t.mode)),t.getComponents()[3]),t.mode)}),[i]}(t,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(t){const e=t.currentTarget;this.colorMode.rawValue=e.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(t=>t.view)}}const Hn=Te("hpl");class $n{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Hn()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const i=t.createElement("div");i.classList.add(Hn("c")),this.element.appendChild(i);const s=t.createElement("div");s.classList.add(Hn("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const t=this.value.rawValue,[e]=t.getComponents("hsv");this.markerElem_.style.backgroundColor=Sn(new Hs([e,100,100],"hsv"));const i=qt(e,0,360,0,100);this.markerElem_.style.left=`${i}%`}onValueChange_(){this.update_()}}class Xn{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new $n(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new vs(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=qt(Ht(t.point.x,0,t.bounds.width),0,t.bounds.width,0,360),s=this.value.rawValue,[,n,r,o]=s.getComponents("hsv");this.value.setRawValue(new Hs([i,n,r,o],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=hs(Zs(!1),cs(t));if(0===e)return;const i=this.value.rawValue,[s,n,r,o]=i.getComponents("hsv");this.value.setRawValue(new Hs([s+e,n,r,o],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==hs(Zs(!1),cs(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Yn=Te("svp");class Wn{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Yn()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const i=t.createElement("canvas");i.height=64,i.width=64,i.classList.add(Yn("c")),this.element.appendChild(i),this.canvasElement=i;const s=t.createElement("div");s.classList.add(Yn("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const t=function(t){const e=t.ownerDocument.defaultView;return e&&"document"in e?t.getContext("2d",{willReadFrequently:!0}):null}(this.canvasElement);if(!t)return;const e=this.value.rawValue.getComponents("hsv"),i=this.canvasElement.width,s=this.canvasElement.height,n=t.getImageData(0,0,i,s),r=n.data;for(let t=0;t<s;t++)for(let n=0;n<i;n++){const o=qt(n,0,i,0,100),a=qt(t,0,s,100,0),l=Bs(e[0],o,a),h=4*(t*i+n);r[h]=l[0],r[h+1]=l[1],r[h+2]=l[2],r[h+3]=255}t.putImageData(n,0,0);const o=qt(e[1],0,100,0,100);this.markerElem_.style.left=`${o}%`;const a=qt(e[2],0,100,100,0);this.markerElem_.style.top=`${a}%`}onValueChange_(){this.update_()}}class Zn{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Wn(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new vs(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=qt(t.point.x,0,t.bounds.width,0,100),s=qt(t.point.y,0,t.bounds.height,100,0),[n,,,r]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new Hs([n,i,s,r],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){us(t.key)&&t.preventDefault();const[e,i,s,n]=this.value.rawValue.getComponents("hsv"),r=Zs(!1),o=hs(r,cs(t)),a=hs(r,ps(t));0===o&&0===a||this.value.setRawValue(new Hs([e,i+o,s+a,n],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){const e=Zs(!1),i=hs(e,cs(t)),s=hs(e,ps(t));0===i&&0===s||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Qn{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.hPaletteC_=new Xn(t,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Zn(t,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=e.supportsAlpha?{palette:new In(t,{value:this.value,viewProps:this.viewProps}),text:new bs(t,{parser:It,props:_t.fromObject({pointerScale:.01,keyScale:.1,formatter:Kt(2)}),value:ft(0,{constraint:new wt({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&ls({primary:this.value,secondary:this.alphaIcs_.text.value,forward:t=>t.getComponents()[3],backward:(t,e)=>{const i=t.getComponents();return i[3]=e,new Hs(i,t.mode)}}),this.textsC_=new Gn(t,{colorType:e.colorType,value:this.value,viewProps:this.viewProps}),this.view=new Xs(t,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:e.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}}const Jn=Te("colsw");class tr{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(Jn()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(Jn("sw")),this.element.appendChild(i),this.swatchElem_=i;const s=t.createElement("button");s.classList.add(Jn("b")),e.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s,this.update_()}update_(){const t=this.value.rawValue;this.swatchElem_.style.backgroundColor=An(t)}onValueChange_(){this.update_()}}class er{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new tr(t,{value:this.value,viewProps:this.viewProps})}}class ir{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=vi.create(e.expanded),this.swatchC_=new er(t,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new es(t,{parser:e.parser,props:_t.fromObject({formatter:e.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new Ns(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===e.pickerLayout?new Qi(t,{viewProps:this.viewProps}):null;const s=new Qn(t,{colorType:e.colorType,supportsAlpha:e.supportsAlpha,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach(t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=s,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(s.view.element),ls({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t,backward:(t,e)=>e})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),gi(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,i=t.relatedTarget;i&&e.contains(i)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,i=Me(t);i&&e.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!we(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.swatchC_.view.buttonElement.focus()}}function sr(t){return js(t.getComponents("rgb")).reduce((t,e)=>t<<8|255&Math.floor(e),0)}function nr(t){return t.getComponents("rgb").reduce((t,e,i)=>t<<8|255&Math.floor(3===i?255*e:e),0)>>>0}function rr(t){return"number"!=typeof t?Hs.black():new Hs([(e=t)>>16&255,e>>8&255,255&e],"rgb");var e}function or(t){return"number"!=typeof t?Hs.black():new Hs([(e=t)>>24&255,e>>16&255,e>>8&255,qt(255&e,0,255,0,1)],"rgb");var e}function ar(t,e){return"object"==typeof t&&!rt(t)&&(e in t&&"number"==typeof t[e])}function lr(t){return ar(t,"r")&&ar(t,"g")&&ar(t,"b")}function hr(t){return lr(t)&&ar(t,"a")}function pr(t){return lr(t)}function cr(t,e){if(t.mode!==e.mode)return!1;if(t.type!==e.type)return!1;const i=t.getComponents(),s=e.getComponents();for(let t=0;t<i.length;t++)if(i[t]!==s[t])return!1;return!0}function ur(t){return"a"in t?[t.r,t.g,t.b,t.a]:[t.r,t.g,t.b]}function dr(t,e){return(i,s)=>{t?function(t,e,i){const s=sn(e,i).toRgbaObject();t.writeProperty("r",s.r),t.writeProperty("g",s.g),t.writeProperty("b",s.b),t.writeProperty("a",s.a)}(i,s,e):function(t,e,i){const s=sn(e,i).toRgbaObject();t.writeProperty("r",s.r),t.writeProperty("g",s.g),t.writeProperty("b",s.b)}(i,s,e)}}const vr=si({id:"input-color-number",type:"input",accept:(t,e)=>{if("number"!=typeof t)return null;if(!function(t){return"color"in t||"color"===t.view}(e))return null;const i=Ws(e);return i?{initialValue:t,params:Object.assign(Object.assign({},i),{supportsAlpha:(s=e,!!(null===(n=null==s?void 0:s.color)||void 0===n?void 0:n.alpha))})}:null;var s,n},binding:{reader:t=>t.params.supportsAlpha?or:rr,equals:cr,writer:t=>function(t){const e=t?nr:sr;return(t,i)=>{Ts(t,e(i))}}(t.params.supportsAlpha)},controller:t=>{var e,i,s;return new ir(t.document,{colorType:"int",expanded:null!==(e=t.params.expanded)&&void 0!==e&&e,formatter:(s=t.params.supportsAlpha,s?t=>An(t,"0x"):t=>Vn(t,"0x")),parser:Pn("int"),pickerLayout:null!==(i=t.params.picker)&&void 0!==i?i:"popup",supportsAlpha:t.params.supportsAlpha,value:t.value,viewProps:t.viewProps})}});function mr(t){return e=>{const i=function(t,e){if(!pr(t))return sn(Hs.black(),e);if("int"===e){const e=ur(t);return new Hs(e,"rgb")}if("float"===e){const e=ur(t);return new Js(e,"rgb")}return sn(Hs.black(),"int")}(e,t);return sn(i,"int")}}function gr(t,e){return i=>t?Dn(i,e):Ln(i,e)}const br=si({id:"input-color-object",type:"input",accept:(t,e)=>{var i;if(!pr(t))return null;const s=Ws(e);return s?{initialValue:t,params:Object.assign(Object.assign({},s),{colorType:null!==(i=Qs(e))&&void 0!==i?i:"int"})}:null},binding:{reader:t=>mr(t.params.colorType),equals:cr,writer:t=>dr(hr(t.initialValue),t.params.colorType)},controller:t=>{var e,i;const s=hr(t.initialValue);return new ir(t.document,{colorType:t.params.colorType,expanded:null!==(e=t.params.expanded)&&void 0!==e&&e,formatter:gr(s,t.params.colorType),parser:Pn("int"),pickerLayout:null!==(i=t.params.picker)&&void 0!==i?i:"popup",supportsAlpha:s,value:t.value,viewProps:t.viewProps})}}),fr=si({id:"input-color-string",type:"input",accept:(t,e)=>{if("string"!=typeof t)return null;if("text"===e.view)return null;const i=En(t,Qs(e));if(!i)return null;const s=Nn(i);if(!s)return null;const n=Ws(e);return n?{initialValue:t,params:Object.assign(Object.assign({},n),{format:i,stringifier:s})}:null},binding:{reader:()=>kn,equals:cr,writer:t=>{const e=function(t){const e=Nn(t);return e?(t,i)=>{Ts(t,e(i))}:null}(t.params.format);if(!e)throw ut.notBindable();return e}},controller:t=>{var e,i;return new ir(t.document,{colorType:t.params.format.type,expanded:null!==(e=t.params.expanded)&&void 0!==e&&e,formatter:t.params.stringifier,parser:Pn("int"),pickerLayout:null!==(i=t.params.picker)&&void 0!==i?i:"popup",supportsAlpha:t.params.format.alpha,value:t.value,viewProps:t.viewProps})}});class _r{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map((t,e)=>{var i,s;return null!==(s=null===(i=this.components[e])||void 0===i?void 0:i.constrain(t))&&void 0!==s?s:t});return this.asm_.fromComponents(e)}}const wr=Te("pndtxt");class xr{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(wr()),this.textViews.forEach(e=>{const i=t.createElement("div");i.classList.add(wr("a")),i.appendChild(e.element),this.element.appendChild(i)})}}class yr{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map((i,s)=>function(t,e,i){return new bs(t,{arrayPosition:0===i?"fst":i===e.axes.length-1?"lst":"mid",parser:e.parser,props:e.axes[i].textProps,value:ft(0,{constraint:e.axes[i].constraint}),viewProps:e.viewProps})}(t,e,s)),this.acs_.forEach((t,i)=>{ls({primary:this.value,secondary:t.value,forward:t=>e.assembly.toComponents(t)[i],backward:(t,s)=>{const n=e.assembly.toComponents(t);return n[i]=s,e.assembly.fromComponents(n)}})}),this.view=new xr(t,{textViews:this.acs_.map(t=>t.view)})}get textControllers(){return this.acs_}}class Cr extends le{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(t){this.controller.valueController.sliderController.props.set("max",t)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(t){this.controller.valueController.sliderController.props.set("min",t)}}const Er=si({id:"input-number",type:"input",accept:(t,e)=>{if("number"!=typeof t)return null;const i=de(e,t=>Object.assign(Object.assign({},te(t)),{options:t.optional.custom(qi),readonly:t.optional.constant(!1)}));return i?{initialValue:t,params:i}:null},binding:{reader:t=>Ut,constraint:t=>function(t,e){const i=[],s=Zt(t,e);s&&i.push(s);const n=Qt(t);n&&i.push(n);const r=Hi(t.options);return r&&i.push(r),new Ui(i)}(t.params,t.initialValue),writer:t=>Ts},controller:t=>{const e=t.value,i=t.constraint,s=i&&zi(i,Ki);if(s)return new Yi(t.document,{props:new _t({options:s.values.value("options")}),value:e,viewProps:t.viewProps});const n=Jt(t.params,e.rawValue),r=i&&zi(i,wt);return r?new Cs(t.document,Object.assign(Object.assign({},Es(Object.assign(Object.assign({},n),{keyScale:ft(n.keyScale),max:r.values.value("max"),min:r.values.value("min")}))),{parser:It,value:e,viewProps:t.viewProps})):new bs(t.document,{parser:It,props:_t.fromObject(n),value:e,viewProps:t.viewProps})},api:t=>"number"!=typeof t.controller.value.rawValue?null:t.controller.valueController instanceof Cs?new Cr(t.controller):t.controller.valueController instanceof Yi?new Bi(t.controller):null});class Pr{constructor(t=0,e=0){this.x=t,this.y=e}getComponents(){return[this.x,this.y]}static isObject(t){if(rt(t))return!1;const e=t.x,i=t.y;return"number"==typeof e&&"number"==typeof i}static equals(t,e){return t.x===e.x&&t.y===e.y}toObject(){return{x:this.x,y:this.y}}}const kr={toComponents:t=>t.getComponents(),fromComponents:t=>new Pr(...t)},Mr=Te("p2d");class Vr{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Mr()),e.viewProps.bindClassModifiers(this.element),Ve(e.expanded,Ye(this.element,Mr(void 0,"expanded")));const i=t.createElement("div");i.classList.add(Mr("h")),this.element.appendChild(i);const s=t.createElement("button");s.classList.add(Mr("b")),s.appendChild(Ce(t,"p2dpad")),e.viewProps.bindDisabled(s),i.appendChild(s),this.buttonElement=s;const n=t.createElement("div");if(n.classList.add(Mr("t")),i.appendChild(n),this.textElement=n,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(Mr("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}const Ar=Te("p2dp");class Sr{constructor(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=t.createElement("div"),this.element.classList.add(Ar()),"popup"===e.layout&&this.element.classList.add(Ar(void 0,"p")),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(Ar("p")),e.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const s=t.createElementNS(fe,"svg");s.classList.add(Ar("g")),this.padElement.appendChild(s),this.svgElem_=s;const n=t.createElementNS(fe,"line");n.classList.add(Ar("ax")),n.setAttributeNS(null,"x1","0"),n.setAttributeNS(null,"y1","50%"),n.setAttributeNS(null,"x2","100%"),n.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(n);const r=t.createElementNS(fe,"line");r.classList.add(Ar("ax")),r.setAttributeNS(null,"x1","50%"),r.setAttributeNS(null,"y1","0"),r.setAttributeNS(null,"x2","50%"),r.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(r);const o=t.createElementNS(fe,"line");o.classList.add(Ar("l")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(o),this.lineElem_=o;const a=t.createElement("div");a.classList.add(Ar("m")),this.padElement.appendChild(a),this.markerElem_=a,e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[t,e]=this.value.rawValue.getComponents(),i=this.props_.get("max"),s=qt(t,-i,+i,0,100),n=qt(e,-i,+i,0,100),r=this.props_.get("invertsY")?100-n:n;this.lineElem_.setAttributeNS(null,"x2",`${s}%`),this.lineElem_.setAttributeNS(null,"y2",`${r}%`),this.markerElem_.style.left=`${s}%`,this.markerElem_.style.top=`${r}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}}function Tr(t,e,i){return[hs(e[0],cs(t)),hs(e[1],ps(t))*(i?1:-1)]}class Lr{constructor(t,e){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new Sr(t,{layout:e.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new vs(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=this.props.get("max"),s=qt(t.point.x,0,t.bounds.width,-i,+i),n=qt(this.props.get("invertsY")?t.bounds.height-t.point.y:t.point.y,0,t.bounds.height,-i,+i);this.value.setRawValue(new Pr(s,n),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onPadKeyDown_(t){us(t.key)&&t.preventDefault();const[e,i]=Tr(t,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));0===e&&0===i||this.value.setRawValue(new Pr(this.value.rawValue.x+e,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(t){const[e,i]=Tr(t,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));0===e&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Rr{constructor(t,e){var i,s;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=vi.create(e.expanded),this.popC_="popup"===e.pickerLayout?new Qi(t,{viewProps:this.viewProps}):null;const n=new Lr(t,{layout:e.pickerLayout,props:new _t({invertsY:ft(e.invertsY),max:ft(e.max),xKeyScale:e.axes[0].textProps.value("keyScale"),yKeyScale:e.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});n.view.allFocusableElements.forEach(t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=n,this.textC_=new yr(t,{assembly:kr,axes:e.axes,parser:e.parser,value:this.value,viewProps:this.viewProps}),this.view=new Vr(t,{expanded:this.foldable_.value("expanded"),pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(i=this.view.buttonElement)||void 0===i||i.addEventListener("blur",this.onPadButtonBlur_),null===(s=this.view.buttonElement)||void 0===s||s.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),ls({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t,backward:(t,e)=>e})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),gi(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,i=t.relatedTarget;i&&e.contains(i)||(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,i=Me(t);i&&e.contains(i)||i&&i===this.view.buttonElement&&!we(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.view.buttonElement.focus()}}function Dr(t){return Pr.isObject(t)?new Pr(t.x,t.y):new Pr}function Fr(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y)}function Or(t,e){var i,s;if(!rt(t.min)||!rt(t.max))return Math.max(Math.abs(null!==(i=t.min)&&void 0!==i?i:0),Math.abs(null!==(s=t.max)&&void 0!==s?s:0));const n=Yt(t);return Math.max(10*Math.abs(n),10*Math.abs(e))}function Nr(t,e){var i,s;const n=Or(ht(t,null!==(i=t.x)&&void 0!==i?i:{}),e.x),r=Or(ht(t,null!==(s=t.y)&&void 0!==s?s:{}),e.y);return Math.max(n,r)}function Br(t){if(!("y"in t))return!1;const e=t.y;return!!e&&("inverted"in e&&!!e.inverted)}const jr=si({id:"input-point2d",type:"input",accept:(t,e)=>{if(!Pr.isObject(t))return null;const i=de(e,t=>Object.assign(Object.assign({},Ms(t)),{expanded:t.optional.boolean,picker:t.optional.custom(Ss),readonly:t.optional.constant(!1),x:t.optional.custom(Vs),y:t.optional.object(Object.assign(Object.assign({},Ms(t)),{inverted:t.optional.boolean}))}));return i?{initialValue:t,params:i}:null},binding:{reader:()=>Dr,constraint:t=>{return e=t.params,i=t.initialValue,new _r({assembly:kr,components:[As(Object.assign(Object.assign({},e),e.x),i.x),As(Object.assign(Object.assign({},e),e.y),i.y)]});var e,i},equals:Pr.equals,writer:()=>Fr},controller:t=>{var e,i;const s=t.document,n=t.value,r=t.constraint,o=[t.params.x,t.params.y];return new Rr(s,{axes:n.rawValue.getComponents().map((e,i)=>{var s;return ee({constraint:r.components[i],initialValue:e,params:ht(t.params,null!==(s=o[i])&&void 0!==s?s:{})})}),expanded:null!==(e=t.params.expanded)&&void 0!==e&&e,invertsY:Br(t.params),max:Nr(t.params,n.rawValue),parser:It,pickerLayout:null!==(i=t.params.picker)&&void 0!==i?i:"popup",value:n,viewProps:t.viewProps})}});class Ir{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(t){if(rt(t))return!1;const e=t.x,i=t.y,s=t.z;return"number"==typeof e&&"number"==typeof i&&"number"==typeof s}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const Ur={toComponents:t=>t.getComponents(),fromComponents:t=>new Ir(...t)};function zr(t){return Ir.isObject(t)?new Ir(t.x,t.y,t.z):new Ir}function Kr(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z)}const qr=si({id:"input-point3d",type:"input",accept:(t,e)=>{if(!Ir.isObject(t))return null;const i=de(e,t=>Object.assign(Object.assign({},Ms(t)),{readonly:t.optional.constant(!1),x:t.optional.custom(Vs),y:t.optional.custom(Vs),z:t.optional.custom(Vs)}));return i?{initialValue:t,params:i}:null},binding:{reader:t=>zr,constraint:t=>{return e=t.params,i=t.initialValue,new _r({assembly:Ur,components:[As(Object.assign(Object.assign({},e),e.x),i.x),As(Object.assign(Object.assign({},e),e.y),i.y),As(Object.assign(Object.assign({},e),e.z),i.z)]});var e,i},equals:Ir.equals,writer:t=>Kr},controller:t=>{const e=t.value,i=t.constraint,s=[t.params.x,t.params.y,t.params.z];return new yr(t.document,{assembly:Ur,axes:e.rawValue.getComponents().map((e,n)=>{var r;return ee({constraint:i.components[n],initialValue:e,params:ht(t.params,null!==(r=s[n])&&void 0!==r?r:{})})}),parser:It,value:e,viewProps:t.viewProps})}});class Gr{constructor(t=0,e=0,i=0,s=0){this.x=t,this.y=e,this.z=i,this.w=s}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(t){if(rt(t))return!1;const e=t.x,i=t.y,s=t.z,n=t.w;return"number"==typeof e&&"number"==typeof i&&"number"==typeof s&&"number"==typeof n}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const Hr={toComponents:t=>t.getComponents(),fromComponents:t=>new Gr(...t)};function $r(t){return Gr.isObject(t)?new Gr(t.x,t.y,t.z,t.w):new Gr}function Xr(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z),t.writeProperty("w",e.w)}const Yr=si({id:"input-point4d",type:"input",accept:(t,e)=>{if(!Gr.isObject(t))return null;const i=de(e,t=>Object.assign(Object.assign({},Ms(t)),{readonly:t.optional.constant(!1),w:t.optional.custom(Vs),x:t.optional.custom(Vs),y:t.optional.custom(Vs),z:t.optional.custom(Vs)}));return i?{initialValue:t,params:i}:null},binding:{reader:t=>$r,constraint:t=>{return e=t.params,i=t.initialValue,new _r({assembly:Hr,components:[As(Object.assign(Object.assign({},e),e.x),i.x),As(Object.assign(Object.assign({},e),e.y),i.y),As(Object.assign(Object.assign({},e),e.z),i.z),As(Object.assign(Object.assign({},e),e.w),i.w)]});var e,i},equals:Gr.equals,writer:t=>Xr},controller:t=>{const e=t.value,i=t.constraint,s=[t.params.x,t.params.y,t.params.z,t.params.w];return new yr(t.document,{assembly:Hr,axes:e.rawValue.getComponents().map((e,n)=>{var r;return ee({constraint:i.components[n],initialValue:e,params:ht(t.params,null!==(r=s[n])&&void 0!==r?r:{})})}),parser:It,value:e,viewProps:t.viewProps})}});const Wr=si({id:"input-string",type:"input",accept:(t,e)=>{if("string"!=typeof t)return null;const i=de(e,t=>({readonly:t.optional.constant(!1),options:t.optional.custom(qi)}));return i?{initialValue:t,params:i}:null},binding:{reader:t=>os,constraint:t=>function(t){const e=[],i=Hi(t.options);return i&&e.push(i),new Ui(e)}(t.params),writer:t=>Ts},controller:t=>{const e=t.document,i=t.value,s=t.constraint,n=s&&zi(s,Ki);return n?new Yi(e,{props:new _t({options:n.values.value("options")}),value:i,viewProps:t.viewProps}):new es(e,{parser:t=>t,props:_t.fromObject({formatter:as}),value:i,viewProps:t.viewProps})},api:t=>"string"!=typeof t.controller.value.rawValue?null:t.controller.valueController instanceof Yi?new Bi(t.controller):null}),Zr={defaultInterval:200,defaultRows:3},Qr=Te("mll");class Jr{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(Qr()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("textarea");i.classList.add(Qr("i")),i.style.height=`calc(var(${ks("containerUnitSize")}) * ${e.rows})`,i.readOnly=!0,e.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.textareaElem_,e=t.scrollTop===t.scrollHeight-t.clientHeight,i=[];this.value.rawValue.forEach(t=>{void 0!==t&&i.push(this.formatter_(t))}),t.textContent=i.join("\n"),e&&(t.scrollTop=t.scrollHeight)}onValueUpdate_(){this.update_()}}class to{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new Jr(t,{formatter:e.formatter,rows:e.rows,value:this.value,viewProps:this.viewProps})}}const eo=Te("sgl");class io{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(eo()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("input");i.classList.add(eo("i")),i.readOnly=!0,i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.value.rawValue,e=t[t.length-1];this.inputElement.value=void 0!==e?this.formatter_(e):""}onValueUpdate_(){this.update_()}}class so{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new io(t,{formatter:e.formatter,value:this.value,viewProps:this.viewProps})}}const no=si({id:"monitor-bool",type:"monitor",accept:(t,e)=>{if("boolean"!=typeof t)return null;const i=de(e,t=>({readonly:t.required.constant(!0),rows:t.optional.number}));return i?{initialValue:t,params:i}:null},binding:{reader:t=>is},controller:t=>{var e;return 1===t.value.rawValue.length?new so(t.document,{formatter:ss,value:t.value,viewProps:t.viewProps}):new to(t.document,{formatter:ss,rows:null!==(e=t.params.rows)&&void 0!==e?e:Zr.defaultRows,value:t.value,viewProps:t.viewProps})}});class ro extends le{get max(){return this.controller.valueController.props.get("max")}set max(t){this.controller.valueController.props.set("max",t)}get min(){return this.controller.valueController.props.get("min")}set min(t){this.controller.valueController.props.set("min",t)}}const oo=Te("grl");class ao{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(oo()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.props_=e.props,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=t.createElementNS(fe,"svg");i.classList.add(oo("g")),i.style.height=`calc(var(${ks("containerUnitSize")}) * ${e.rows})`,this.element.appendChild(i),this.svgElem_=i;const s=t.createElementNS(fe,"polyline");this.svgElem_.appendChild(s),this.lineElem_=s;const n=t.createElement("div");n.classList.add(oo("t"),Te("tt")()),this.element.appendChild(n),this.tooltipElem_=n,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const{clientWidth:t,clientHeight:e}=this.element,i=this.value.rawValue.length-1,s=this.props_.get("min"),n=this.props_.get("max"),r=[];this.value.rawValue.forEach((o,a)=>{if(void 0===o)return;const l=qt(a,0,i,0,t),h=qt(o,s,n,e,0);r.push([l,h].join(","))}),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const o=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(void 0===a)return void o.classList.remove(oo("t","a"));const l=qt(this.cursor_.rawValue,0,i,0,t),h=qt(a,s,n,e,0);o.style.left=`${l}px`,o.style.top=`${h}px`,o.textContent=`${this.formatter_(a)}`,o.classList.contains(oo("t","a"))||(o.classList.add(oo("t","a"),oo("t","in")),_e(o),o.classList.remove(oo("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class lo{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.cursor_=ft(-1),this.view=new ao(t,{cursor:this.cursor_,formatter:e.formatter,rows:e.rows,props:this.props,value:this.value,viewProps:this.viewProps}),we(t)){const t=new vs(this.view.element);t.emitter.on("down",this.onGraphPointerDown_),t.emitter.on("move",this.onGraphPointerMove_),t.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}importProps(t){return ve(t,null,t=>({max:t.required.number,min:t.required.number}),t=>(this.props.set("max",t.max),this.props.set("min",t.min),!0))}exportProps(){return me(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(t){const{clientWidth:e}=this.view.element;this.cursor_.rawValue=Math.floor(qt(t.offsetX,0,e,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){t.data.point?this.cursor_.rawValue=Math.floor(qt(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.rawValue=-1}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function ho(t){return rt(t.format)?Kt(2):t.format}function po(t){return"graph"===t.view}const co=si({id:"monitor-number",type:"monitor",accept:(t,e)=>{if("number"!=typeof t)return null;const i=de(e,t=>({format:t.optional.function,max:t.optional.number,min:t.optional.number,readonly:t.required.constant(!0),rows:t.optional.number,view:t.optional.string}));return i?{initialValue:t,params:i}:null},binding:{defaultBufferSize:t=>po(t)?64:1,reader:t=>Ut},controller:t=>po(t.params)?function(t){var e,i,s;return new lo(t.document,{formatter:ho(t.params),rows:null!==(e=t.params.rows)&&void 0!==e?e:Zr.defaultRows,props:_t.fromObject({max:null!==(i=t.params.max)&&void 0!==i?i:100,min:null!==(s=t.params.min)&&void 0!==s?s:0}),value:t.value,viewProps:t.viewProps})}(t):function(t){var e;return 1===t.value.rawValue.length?new so(t.document,{formatter:ho(t.params),value:t.value,viewProps:t.viewProps}):new to(t.document,{formatter:ho(t.params),rows:null!==(e=t.params.rows)&&void 0!==e?e:Zr.defaultRows,value:t.value,viewProps:t.viewProps})}(t),api:t=>t.controller.valueController instanceof lo?new ro(t.controller):null}),uo=si({id:"monitor-string",type:"monitor",accept:(t,e)=>{if("string"!=typeof t)return null;const i=de(e,t=>({multiline:t.optional.boolean,readonly:t.required.constant(!0),rows:t.optional.number}));return i?{initialValue:t,params:i}:null},binding:{reader:t=>os},controller:t=>{var e;const i=t.value;return i.rawValue.length>1||t.params.multiline?new to(t.document,{formatter:as,rows:null!==(e=t.params.rows)&&void 0!==e?e:Zr.defaultRows,value:i,viewProps:t.viewProps}):new so(t.document,{formatter:as,value:i,viewProps:t.viewProps})}});class vo{constructor(t){this.target=t.target,this.reader_=t.reader,this.writer_=t.writer}read(){return this.reader_(this.target.read())}write(t){this.writer_(this.target,t)}inject(t){this.write(this.reader_(t))}}class mo{constructor(t){this.target=t.target,this.reader_=t.reader}read(){return this.reader_(this.target.read())}}function go(t,e){return 0===e?new ji:new Ii(t,null!=e?e:Zr.defaultInterval)}class bo{constructor(t){this.pluginsMap_={blades:[],inputs:[],monitors:[]},this.apiCache_=t}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(t,e){if(!(i=e.core)||i.major!==ii.major)throw ut.notCompatible(t,e.id);var i;"blade"===e.type?this.pluginsMap_.blades.unshift(e):"input"===e.type?this.pluginsMap_.inputs.unshift(e):"monitor"===e.type&&this.pluginsMap_.monitors.unshift(e)}createInput_(t,e,i){return this.pluginsMap_.inputs.reduce((s,n)=>null!=s?s:function(t,e){var i;const s=t.accept(e.target.read(),e.params);if(rt(s))return null;const n={target:e.target,initialValue:s.initialValue,params:s.params},r=de(e.params,t=>({disabled:t.optional.boolean,hidden:t.optional.boolean,label:t.optional.string,tag:t.optional.string})),o=t.binding.reader(n),a=t.binding.constraint?t.binding.constraint(n):void 0,l=new vo({reader:o,target:e.target,writer:t.binding.writer(n)}),h=new he(ft(o(s.initialValue),{constraint:a,equals:t.binding.equals}),l),p=t.controller({constraint:a,document:e.document,initialValue:s.initialValue,params:s.params,value:h,viewProps:Ei.create({disabled:null==r?void 0:r.disabled,hidden:null==r?void 0:r.hidden})});return new Ue(e.document,{blade:di(),props:_t.fromObject({label:"label"in e.params?null!==(i=null==r?void 0:r.label)&&void 0!==i?i:null:e.target.key}),tag:null==r?void 0:r.tag,value:h,valueController:p})}(n,{document:t,target:e,params:i}),null)}createMonitor_(t,e,i){return this.pluginsMap_.monitors.reduce((s,n)=>null!=s?s:function(t,e){var i,s,n;const r=t.accept(e.target.read(),e.params);if(rt(r))return null;const o={target:e.target,initialValue:r.initialValue,params:r.params},a=de(e.params,t=>({bufferSize:t.optional.number,disabled:t.optional.boolean,hidden:t.optional.boolean,interval:t.optional.number,label:t.optional.string})),l=t.binding.reader(o),h=null!==(s=null!==(i=null==a?void 0:a.bufferSize)&&void 0!==i?i:t.binding.defaultBufferSize&&t.binding.defaultBufferSize(r.params))&&void 0!==s?s:1,p=new Ge({binding:new mo({reader:l,target:e.target}),bufferSize:h,ticker:go(e.document,null==a?void 0:a.interval)}),c=t.controller({document:e.document,params:r.params,value:p,viewProps:Ei.create({disabled:null==a?void 0:a.disabled,hidden:null==a?void 0:a.hidden})});return c.viewProps.bindDisabled(p.ticker),c.viewProps.handleDispose(()=>{p.ticker.dispose()}),new He(e.document,{blade:di(),props:_t.fromObject({label:"label"in e.params?null!==(n=null==a?void 0:a.label)&&void 0!==n?n:null:e.target.key}),value:p,valueController:c})}(n,{document:t,params:i,target:e}),null)}createBinding(t,e,i){if(rt(e.read()))throw new ut({context:{key:e.key},type:"nomatchingcontroller"});const s=this.createInput_(t,e,i);if(s)return s;const n=this.createMonitor_(t,e,i);if(n)return n;throw new ut({context:{key:e.key},type:"nomatchingcontroller"})}createBlade(t,e){const i=this.pluginsMap_.blades.reduce((i,s)=>null!=i?i:function(t,e){const i=t.accept(e.params);if(!i)return null;const s=de(e.params,t=>({disabled:t.optional.boolean,hidden:t.optional.boolean}));return t.controller({blade:di(),document:e.document,params:Object.assign(Object.assign({},i.params),{disabled:null==s?void 0:s.disabled,hidden:null==s?void 0:s.hidden}),viewProps:Ei.create({disabled:null==s?void 0:s.disabled,hidden:null==s?void 0:s.hidden})})}(s,{document:t,params:e}),null);if(!i)throw new ut({type:"nomatchingview",context:{params:e}});return i}createInputBindingApi_(t){const e=this.pluginsMap_.inputs.reduce((e,i)=>{var s,n;return e||(null!==(n=null===(s=i.api)||void 0===s?void 0:s.call(i,{controller:t}))&&void 0!==n?n:null)},null);return this.apiCache_.add(t,null!=e?e:new le(t))}createMonitorBindingApi_(t){const e=this.pluginsMap_.monitors.reduce((e,i)=>{var s,n;return e||(null!==(n=null===(s=i.api)||void 0===s?void 0:s.call(i,{controller:t}))&&void 0!==n?n:null)},null);return this.apiCache_.add(t,null!=e?e:new le(t))}createBindingApi(t){if(this.apiCache_.has(t))return this.apiCache_.get(t);if(ze(t))return this.createInputBindingApi_(t);if($e(t))return this.createMonitorBindingApi_(t);throw ut.shouldNeverHappen()}createApi(t){if(this.apiCache_.has(t))return this.apiCache_.get(t);if(function(t){return ge(t)&&be(t.value)}(t))return this.createBindingApi(t);const e=this.pluginsMap_.blades.reduce((e,i)=>null!=e?e:i.api({controller:t,pool:this}),null);if(!e)throw ut.shouldNeverHappen();return this.apiCache_.add(t,e)}}const fo=new class{constructor(){this.map_=new Map}get(t){var e;return null!==(e=this.map_.get(t))&&void 0!==e?e:null}has(t){return this.map_.has(t)}add(t,e){return this.map_.set(t,e),t.viewProps.handleDispose(()=>{this.map_.delete(t)}),e}};class _o extends ie{constructor(t){super(t),this.emitter_=new vt,this.controller.value.emitter.on("change",t=>{this.emitter_.emit("change",new ne(this,t.rawValue))})}get label(){return this.controller.labelController.props.get("label")}set label(t){this.controller.labelController.props.set("label",t)}get options(){return this.controller.valueController.props.get("options")}set options(t){this.controller.valueController.props.set("options",t)}get value(){return this.controller.value.rawValue}set value(t){this.controller.value.rawValue=t}on(t,e){const i=e.bind(this);return this.emitter_.on(t,t=>{i(t)},{key:e}),this}off(t,e){return this.emitter_.off(t,e),this}}class wo extends ie{}class xo extends ie{constructor(t){super(t),this.emitter_=new vt,this.controller.value.emitter.on("change",t=>{this.emitter_.emit("change",new ne(this,t.rawValue))})}get label(){return this.controller.labelController.props.get("label")}set label(t){this.controller.labelController.props.set("label",t)}get max(){return this.controller.valueController.sliderController.props.get("max")}set max(t){this.controller.valueController.sliderController.props.set("max",t)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(t){this.controller.valueController.sliderController.props.set("min",t)}get value(){return this.controller.value.rawValue}set value(t){this.controller.value.rawValue=t}on(t,e){const i=e.bind(this);return this.emitter_.on(t,t=>{i(t)},{key:e}),this}off(t,e){return this.emitter_.off(t,e),this}}class yo extends ie{constructor(t){super(t),this.emitter_=new vt,this.controller.value.emitter.on("change",t=>{this.emitter_.emit("change",new ne(this,t.rawValue))})}get label(){return this.controller.labelController.props.get("label")}set label(t){this.controller.labelController.props.set("label",t)}get formatter(){return this.controller.valueController.props.get("formatter")}set formatter(t){this.controller.valueController.props.set("formatter",t)}get value(){return this.controller.value.rawValue}set value(t){this.controller.value.rawValue=t}on(t,e){const i=e.bind(this);return this.emitter_.on(t,t=>{i(t)},{key:e}),this}off(t,e){return this.emitter_.off(t,e),this}}const Co={id:"list",type:"blade",core:ii,accept(t){const e=de(t,t=>({options:t.required.custom(qi),value:t.required.raw,view:t.required.constant("list"),label:t.optional.string}));return e?{params:e}:null},controller(t){const e=new Ki(Gi(t.params.options)),i=ft(t.params.value,{constraint:e}),s=new Yi(t.document,{props:new _t({options:e.values.value("options")}),value:i,viewProps:t.viewProps});return new Be(t.document,{blade:t.blade,props:_t.fromObject({label:t.params.label}),value:i,valueController:s})},api:t=>t.controller instanceof Be&&t.controller.valueController instanceof Yi?new _o(t.controller):null};class Eo extends bi{constructor(t,e){super(t,e)}get element(){return this.controller.view.element}}class Po extends wi{constructor(t,e){super(t,{expanded:e.expanded,blade:e.blade,props:e.props,root:!0,viewProps:e.viewProps})}}const ko=Te("spr");class Mo{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ko()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("hr");i.classList.add(ko("r")),this.element.appendChild(i)}}class Vo extends Ne{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new Mo(t,{viewProps:e.viewProps})}))}}const Ao={id:"separator",type:"blade",core:ii,accept(t){const e=de(t,t=>({view:t.required.constant("separator")}));return e?{params:e}:null},controller:t=>new Vo(t.document,{blade:t.blade,viewProps:t.viewProps}),api:t=>t.controller instanceof Vo?new wo(t.controller):null},So={id:"slider",type:"blade",core:ii,accept(t){const e=de(t,t=>({max:t.required.number,min:t.required.number,view:t.required.constant("slider"),format:t.optional.function,label:t.optional.string,value:t.optional.number}));return e?{params:e}:null},controller(t){var e,i;const s=null!==(e=t.params.value)&&void 0!==e?e:0,n=new wt({max:t.params.max,min:t.params.min}),r=ft(s,{constraint:n}),o=new Cs(t.document,Object.assign(Object.assign({},Es({formatter:null!==(i=t.params.format)&&void 0!==i?i:zt,keyScale:ft(1),max:n.values.value("max"),min:n.values.value("min"),pointerScale:Wt(t.params,s)})),{parser:It,value:r,viewProps:t.viewProps}));return new Be(t.document,{blade:t.blade,props:_t.fromObject({label:t.params.label}),value:r,valueController:o})},api:t=>t.controller instanceof Be&&t.controller.valueController instanceof Cs?new xo(t.controller):null},To={id:"text",type:"blade",core:ii,accept(t){const e=de(t,t=>({parse:t.required.function,value:t.required.raw,view:t.required.constant("text"),format:t.optional.function,label:t.optional.string}));return e?{params:e}:null},controller(t){var e;const i=ft(t.params.value),s=new es(t.document,{parser:t.params.parse,props:_t.fromObject({formatter:null!==(e=t.params.format)&&void 0!==e?e:t=>String(t)}),value:i,viewProps:t.viewProps});return new Be(t.document,{blade:t.blade,props:_t.fromObject({label:t.params.label}),value:i,valueController:s})},api:t=>t.controller instanceof Be&&t.controller.valueController instanceof es?new yo(t.controller):null};class Lo extends Eo{constructor(t){var e,i;const s=null!=t?t:{},n=null!==(e=s.document)&&void 0!==e?e:xe(),r=function(){const t=new bo(fo);return[jr,qr,Yr,Wr,Er,fr,br,vr,Fs,no,uo,co,ni,xi,Ni].forEach(e=>{t.register("core",e)}),t}();super(new Po(n,{expanded:s.expanded,blade:di(),props:_t.fromObject({title:s.title}),viewProps:Ei.create()}),r),this.pool_=r,this.containerElem_=null!==(i=s.container)&&void 0!==i?i:function(t){const e=t.createElement("div");return e.classList.add(Te("dfw")()),t.body&&t.body.appendChild(e),e}(n),this.containerElem_.appendChild(this.element),this.doc_=n,this.usesDefaultWrapper_=!s.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw ut.alreadyDisposed();return this.doc_}dispose(){const t=this.containerElem_;if(!t)throw ut.alreadyDisposed();if(this.usesDefaultWrapper_){const e=t.parentElement;e&&e.removeChild(t)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(t){t.css&&function(t,e,i){if(t.querySelector(`style[data-tp-style=${e}]`))return;const s=t.createElement("style");s.dataset.tpStyle=e,s.textContent=i,t.head.appendChild(s)}(this.document,`plugin-${t.id}`,t.css);("plugin"in t?[t.plugin]:"plugins"in t?t.plugins:[]).forEach(e=>{this.pool_.register(t.id,e)})}setUpDefaultPlugins_(){this.registerPlugin({id:"default",css:'.tp-tbiv_b,.tp-coltxtv_ms,.tp-colswv_b,.tp-ckbv_i,.tp-sglv_i,.tp-mllv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-rotv_b,.tp-fldv_b,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--bld-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--cnt-usz);line-height:var(--cnt-usz);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tbpv_c>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-vp))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tbpv_c>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--cnt-usp)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tbpv_c>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tbpv_c>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tbpv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tbpv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tbpv_c>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tbpv_c>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--bld-br);border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tbpv_c .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tbpv_c>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tbpv_c>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--bld-br)}.tp-tbpv_c .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--bld-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);overflow:hidden;padding-left:var(--cnt-hp);padding-right:calc(4px + var(--cnt-usz) + var(--cnt-hp));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-hp) + (var(--cnt-usz) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-vp);padding-top:var(--cnt-vp);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--cnt-usz);line-height:var(--cnt-usz);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-sglv_i,.tp-mllv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--mo-fg);height:var(--cnt-usz);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-sglv_i::-webkit-scrollbar,.tp-mllv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-sglv_i::-webkit-scrollbar-corner,.tp-mllv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-sglv_i::-webkit-scrollbar-thumb,.tp-mllv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-rotv{--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-br: var(--tp-base-border-radius, 6px);--bs-ff: var(--tp-base-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--bld-br: var(--tp-blade-border-radius, 2px);--bld-hp: var(--tp-blade-horizontal-padding, 4px);--bld-vw: var(--tp-blade-value-width, 160px);--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--cnt-hp: var(--tp-container-horizontal-padding, 4px);--cnt-vp: var(--tp-container-vertical-padding, 4px);--cnt-usp: var(--tp-container-unit-spacing, 4px);--cnt-usz: var(--tp-container-unit-size, 20px);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--bld-br);cursor:pointer;display:block;height:var(--cnt-usz);position:relative;width:var(--cnt-usz)}.tp-ckbv_w svg{display:block;height:16px;inset:0;margin:auto;opacity:0;position:absolute;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--cnt-usz)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--cnt-usp);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-hp));right:calc(-1*var(--cnt-hp));top:var(--cnt-usz)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--cnt-usp)}.tp-colpv_rgb{display:flex;margin-top:var(--cnt-usp);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-vp);padding-top:calc(var(--cnt-vp) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-hp));position:absolute;right:calc(-1*var(--cnt-hp));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--bld-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--cnt-usz)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{inset:0;position:absolute}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--bld-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;inset:0;position:absolute}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--bld-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{cursor:pointer;display:block;height:var(--cnt-usz);left:0;position:absolute;top:0;width:var(--cnt-usz)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--bld-br);content:"";display:block;inset:0;position:absolute}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--bld-br);color:var(--lbl-fg);cursor:pointer;height:var(--cnt-usz);line-height:var(--cnt-usz);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--cnt-usz)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-hp);padding-right:var(--cnt-hp)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:var(--bld-vw)}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 var(--bld-hp);width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--cnt-usz)*3);line-height:var(--cnt-usz);padding-left:var(--bld-hp);padding-right:var(--bld-hp);resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--cnt-usz);margin-right:4px;position:relative;width:var(--cnt-usz)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--cnt-usp);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-hp));right:calc(-1*var(--cnt-hp));top:var(--cnt-usz)}.tp-p2dpv{padding-left:calc(var(--cnt-usz) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:var(--bld-vw);padding:var(--cnt-vp) var(--cnt-hp);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--cnt-usz);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";display:block;height:2px;inset:0;margin:auto;position:absolute}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;content:"";display:block;height:2px;inset:0;margin-bottom:auto;margin-top:auto;position:absolute}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--bld-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:"";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--cnt-usz) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-hp) + 4px);padding-right:calc(var(--cnt-hp) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);content:"";inset:0 0 2px;pointer-events:none;position:absolute}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);opacity:.5;overflow:hidden;position:relative;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-tbpv_c{padding-bottom:var(--cnt-vp);padding-left:4px;padding-top:var(--cnt-vp)}.tp-txtv{position:relative}.tp-txtv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:calc(var(--bld-hp) - 5px);position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--cnt-usz) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--bld-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--bs-ff);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--cnt-usz) + var(--cnt-hp));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0;transition-delay:0s;transition-duration:0s}.tp-rotv.tp-rotv-not>.tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst.tp-fldv-expanded>.tp-fldv_b{transition-delay:0s;transition-duration:0s}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}',plugins:[Co,Ao,So,Ni,To]})}}new ei("4.0.5");var Ro=nt.resolveLygia;export{G as Camera,Y as Mesh,Lo as Pane,et as Plane,f as Program,tt as RenderTarget,P as Renderer,Ro as resolveLygia};
